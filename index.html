<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://blog.exiahan.com">
  <title>ExiaHan&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I am a 逗比.">
<meta property="og:type" content="website">
<meta property="og:title" content="ExiaHan&#39;s Blog">
<meta property="og:url" content="http://blog.exiahan.com/index.html">
<meta property="og:site_name" content="ExiaHan&#39;s Blog">
<meta property="og:description" content="I am a 逗比.">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ExiaHan&#39;s Blog">
<meta name="twitter:description" content="I am a 逗比.">
  
    <link rel="alternative" href="/atom.xml" title="ExiaHan&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" type="text/css" href="/./main.4a39e8.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/avatar.png" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">ExiaHan</a></h1>
		</hgroup>
		
		<p class="header-subtitle">Record everything, day by day. 记录岁月，记录一切。</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/archives">所有文章</a></li>
	        
				<li><a href="/tags/LifeContinues">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/exiahan" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="http://weibo.com/exiahan" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="rss" target="_blank" href="/atom.xml" title="rss"><i class="icon-rss"></i></a>
		        
					<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/exiahan" title="zhihu"><i class="icon-zhihu"></i></a>
		        
					<a class="douban" target="_blank" href="http://www.douban.com/people/ExiaHan/" title="douban"><i class="icon-douban"></i></a>
		        
					<a class="mail" target="_blank" href="/hanyang.945@gmail.com" title="mail"><i class="icon-mail"></i></a>
		        
					<a class="google" target="_blank" href="https://plus.google.com/u/0/105501044492895514671" title="google"><i class="icon-google"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/avatar.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">ExiaHan</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>Record everything, day by day. 记录岁月，记录一切。<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/exiahan" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/exiahan" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss"><i class="icon-rss"></i></a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/exiahan" title="zhihu"><i class="icon-zhihu"></i></a>
			        
						<a class="douban" target="_blank" href="http://www.douban.com/people/ExiaHan/" title="douban"><i class="icon-douban"></i></a>
			        
						<a class="mail" target="_blank" href="/hanyang.945@gmail.com" title="mail"><i class="icon-mail"></i></a>
			        
						<a class="google" target="_blank" href="https://plus.google.com/u/0/105501044492895514671" title="google"><i class="icon-google"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 33.333333333333336%"><a href="/">主页</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/archives">所有文章</a></li>
		        
					<li style="width: 33.333333333333336%"><a href="/tags/LifeContinues">随笔</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-Summary-of-2018" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/04/Summary-of-2018/">Summary of 2018</a>
    </h1>
  

        
        <a href="/2019/02/04/Summary-of-2018/" class="archive-article-date">
  	<time datetime="2019-02-04T15:26:27.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-02-04</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="2018"><a href="#2018" class="headerlink" title="2018"></a>2018</h1><p>2018年对咱来说是结束也是开始 ———— 四月份的毕业证意味着相对无忧无虑的学生时代的终结，同时签下的工作合同也表示作为”社会人“的开始(可惜咱不是佩奇:))。咱在学校是幸运的，不仅有厉害的室友，还有厉害的各位老师，还有各路非常非常厉害的学长学弟，多谢各路大佬一路带咱平地起飞，咱这几年学到的东西确实不少，当然咱这几年学到的学习方法会帮助咱一路前行。<br>工作方面，拿大彪哥的说法是咱们终于都做了”社畜“，很幸运的进到了现在的公司，进到了非常好的Team，遇到了无敌强的老大和无敌强的同事们。多谢各路大佬不吝赐教带咱继续前行，让咱有幸抱着大腿去了两趟霓虹(必须要跪谢Team，跪谢公司)，学到了在学校不知道的东西，同时也扭转了部分不适用于工业的学院思维。<br>生活方面，作为YoungHo Lee 歌词里的”连头款也凑不到“的”无为青年“，压力肯定是有的，但是就像很早以前的一个”酱油“(没错，真的是酱油广告，但是我不打酱油:))说的，”生活是道菜“，酸甜苦辣总归都会尝到，所以咱会自然对待(毕竟作为Eason Chan的Fan，”黑暗过会是晨曦“是时不时就会唱出来的)。</p>
<h1 id="2019"><a href="#2019" class="headerlink" title="2019"></a>2019</h1><p>对于2019年，咱不能说一定要怎么怎么样，但是咱总会尽力让2019好于2018，不然也太对不起<code>2019 &gt; 2018</code>这个不等式了2333333。<br>其实鸭，还有好多没学，再把2018年没干完的计划累到2019年，咱现在只能对自己说不管什么时候都尽量让自己能够”百尺竿头，更进一步“啦～(真要说的话，借用大佬的话，希望咱新的一年可以Bug多多，Paper多多，当然最好能有个不嫌弃咱的妹子哈哈哈哈哈～)</p>
<p>就这样，祝大家己亥年新年快乐，万事如意，想长个的长个，想变壮的变壮，想变强的变强(当然头发还是要有的，不能做埼玉老师啊哈哈哈哈)，想变大胸的立马大胸(逃～～～～～)</p>
<p><strong>最后吐槽一下，今年春晚一如既往的不太好看，也就相声小品还行(当然也要切掉某些惯例那啥桥段才行)，然后如果你发现上面某些地方逻辑不连贯，那肯定是我在看春晚小品相声哈哈哈哈～</strong></p>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/YQPaoggpn74?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">Life</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Vision</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/Life/" class="article-tag-list-link color5">Life</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="/categories/Vision/" class="article-tag-list-link color2">Vision</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Build-SQLITE-For-Android" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/01/Build-SQLITE-For-Android/">Build SQLITE For Android</a>
    </h1>
  

        
        <a href="/2018/08/01/Build-SQLITE-For-Android/" class="archive-article-date">
  	<time datetime="2018-08-01T14:18:20.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2018-08-01</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Describe"><a href="#Describe" class="headerlink" title="Describe"></a>Describe</h1><p>Recently I need to use sqlite3 to quickly modify values in a db file located in an android device.  Usually the easy way is to directly copy an sqlite3 ELF file from an exist AOSP rom’s side products of target architecture, but sometimes we may not have any aosp rom built on our disk or even no aosp source files on disk. So it may be not convenience to archive a executable sqlite3 ELF file from a built rom’s side products. So it will be  fine to build sqlite3 from sqlite3 source file directly. This article will tell you how to build a usable sqlite3 from sqlite’s source file via android-ndk.</p>
<p><strong>I Assume you are using Linux.</strong></p>
<h2 id="Prepare"><a href="#Prepare" class="headerlink" title="Prepare"></a>Prepare</h2><ul>
<li>ANDROID NDK: Because we are going to build ELF file for android, so you must have <a href="https://developer.android.com/ndk/" target="_blank" rel="noopener">Android-NDK</a> installed. If you don’t have it, install it via distribution’s package manager(If you are using Linux) or directly download from official site.</li>
<li>The Source File: Then we should download the source file of sqlite. The source file can be downloaded easily from its <a href="https://www.sqlite.org/download.html" target="_blank" rel="noopener">Official Site</a>. </li>
<li>Essential Building Components: Also make sure your system has essential building components installed. If it alerts any missing when building, just install them.</li>
</ul>
<h2 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h2><p>Now everything is ok. We can start our building action. To avoid any not errors when building. Here I recommend you use the <a href="https://developer.android.com/ndk/guides/standalone_toolchain" target="_blank" rel="noopener">Standalone ToolChain</a>. </p>
<p>A standalone toolchain can be easily setup via do what the tutorial says.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create an arm64 API 26 libc++ toolchain.</span></span><br><span class="line"><span class="built_in">export</span> NDK=&#123;path to ndk&#125;</span><br><span class="line"><span class="variable">$NDK</span>/build/tools/make_standalone_toolchain.py \</span><br><span class="line">  --arch arm64 \</span><br><span class="line">  --api 26 \</span><br><span class="line">  --stl=libc++ \</span><br><span class="line">  --install-dir=/&#123;path you want&#125;/&#123;tool chain name&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment"># Add the standalone toolchain to the search path.</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/&#123;path you want&#125;/&#123;tool chain name&#125;/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tell configure what tools to use.</span></span><br><span class="line"><span class="comment"># If you want armeabi, just change target_host to</span></span><br><span class="line"><span class="comment"># target_host=arm-linux-androideabi</span></span><br><span class="line">target_host=aarch64-linux-android</span><br><span class="line"><span class="built_in">export</span> AR=<span class="variable">$target_host</span>-ar</span><br><span class="line"><span class="built_in">export</span> AS=<span class="variable">$target_host</span>-clang</span><br><span class="line"><span class="built_in">export</span> CC=<span class="variable">$target_host</span>-clang</span><br><span class="line"><span class="built_in">export</span> CXX=<span class="variable">$target_host</span>-clang++</span><br><span class="line"><span class="built_in">export</span> LD=<span class="variable">$target_host</span>-ld</span><br><span class="line"><span class="built_in">export</span> STRIP=<span class="variable">$target_host</span>-strip</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tell configure what flags Android requires.</span></span><br><span class="line"><span class="built_in">export</span> CFLAGS=<span class="string">"-fPIE -fPIC"</span></span><br><span class="line"><span class="built_in">export</span> LDFLAGS=<span class="string">"-pie"</span></span><br></pre></td></tr></table></figure>
<p>Now everything is ok. Extract the source file to some place you want, then use configure and make like below shows, the sqlite ELF file will be generated successfully.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$tar</span> -xzvf sqlite-snapshot-201807272333.tar.gz</span><br><span class="line">$./configure --host=arm-linux-androideabi</span><br><span class="line"><span class="variable">$make</span></span><br><span class="line">...</span><br><span class="line"><span class="variable">$file</span> sqlite3</span><br><span class="line">sqlite3: ELF 32-bit LSB pie executable ARM, EABI5 version 1 (SYSV), dynamically linked, interpreter /system/bin/linker, with debug_info, not stripped</span><br></pre></td></tr></table></figure>
<p>All done. </p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">Android</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">ArchLinux</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Linux</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Build</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">SQLITE</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/DevOps/" class="article-tag-list-link color2">DevOps</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-x64-and-arm64-ABI-in-Linux" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/01/x64-and-arm64-ABI-in-Linux/">x64 and arm64 ABI in Linux</a>
    </h1>
  

        
        <a href="/2018/06/01/x64-and-arm64-ABI-in-Linux/" class="archive-article-date">
  	<time datetime="2018-06-01T14:10:20.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2018-06-01</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="x64-and-arm64-ABI-in-Linux"><a href="#x64-and-arm64-ABI-in-Linux" class="headerlink" title="x64 and arm64 ABI in Linux"></a>x64 and arm64 ABI in Linux</h1><p>##TL;DR</p>
<p>Ok, it has been a few months since Arch Linux announced that it will only provide x64 image in the future. Android also has been support x64 and arm64 for a long time.  Seems that it’s true that x86 is on the way of out of time. So it’s time to learn some thing about the ABI in x64 and arm64.</p>
<p><strong>PS:</strong> If you’ve read the ABI manual about Linux on X64/Arm64, there is no need to read this article. It’s just for beginners and lazy guys who don’t want to read manual. </p>
<h2 id="Language-we-used-to-study"><a href="#Language-we-used-to-study" class="headerlink" title="Language we used to study"></a>Language we used to study</h2><p>As we know that C/C++ is the best language for us to research the ABI because they cover both “<strong>Procedure Oriented</strong>“ and “<strong>Object Oriented</strong>“ language. So we will use simple C/C++ console application to dig the details about ABI. Now let’s rock.</p>
<h2 id="x64"><a href="#x64" class="headerlink" title="x64"></a>x64</h2><p>First we will analysis the x64 architecture. Please view the C source code below.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exputs</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s, <span class="keyword">const</span> <span class="keyword">char</span> *s1, <span class="keyword">const</span> <span class="keyword">char</span>*s2, <span class="keyword">const</span> <span class="keyword">char</span> *s3, <span class="keyword">const</span> <span class="keyword">char</span> *s4, <span class="keyword">const</span> <span class="keyword">char</span> *s5, <span class="keyword">const</span> <span class="keyword">char</span> *s6)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(s1);</span><br><span class="line">  <span class="built_in">puts</span>(s2);</span><br><span class="line">  <span class="built_in">puts</span>(s3);</span><br><span class="line">  <span class="built_in">puts</span>(s4);</span><br><span class="line">  <span class="built_in">puts</span>(s5);</span><br><span class="line">  <span class="built_in">puts</span>(s6);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  exputs(<span class="string">"Zero\n"</span>, <span class="string">"One\n"</span>, <span class="string">"Two\n"</span>, <span class="string">"Three\n"</span>, <span class="string">"Four\n"</span>, <span class="string">"Five\n"</span>, <span class="string">"Six\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">ABI</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">Security</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/Security/" class="article-tag-list-link color4">Security</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Start-To-Use-Nginx-Hexo-and-Let-s-Encrypt" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/30/Start-To-Use-Nginx-Hexo-and-Let-s-Encrypt/">Start To Use Nginx Hexo and Let&#39;s Encrypt</a>
    </h1>
  

        
        <a href="/2017/01/30/Start-To-Use-Nginx-Hexo-and-Let-s-Encrypt/" class="archive-article-date">
  	<time datetime="2017-01-29T19:51:33.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-01-30</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h2><p>It’s just a record for myself. It may contain errors. But it still can help you if you don’t know how to start the config.<br>For a Offical instruction, you may try this in <a href="https://www.digitalocean.com/community/tags/let-s-encrypt?type=tutorials" target="_blank" rel="noopener">Digital Ocean</a>.<br><strong>And what I think is that: The tutorials in DigitalOcean is much better that what is written in some linux distribution’s wikipage like ubuntu….</strong></p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>It is time to embrace https since chrome begin to mark website which use http as unsafe. As we know hexo are just a static html server, so if we want to use https, we need a <strong>real</strong> web server, which should supports https. What I choose is Nginx, it small, simple, elegent and stable. Below will show you how to set up nginx to support https and how to let nginx work with hexo and git.</p>
<p>## </p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Nginx</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Https</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">Hexo</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/Blog/" class="article-tag-list-link color5">Blog</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Expand-A-Logical-Volume-In-LVM" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/29/Expand-A-Logical-Volume-In-LVM/">Expand A Logical Volume In LVM</a>
    </h1>
  

        
        <a href="/2017/01/29/Expand-A-Logical-Volume-In-LVM/" class="archive-article-date">
  	<time datetime="2017-01-28T19:29:32.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-01-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>This blog is used to record the instructions about how to expand a logic volume in lvm.</p>
<p><strong>CAUTION!</strong></p>
<ul>
<li><em>What I write here may not completely right because there have been one month passed since I complete migrate my data to SSD.</em></li>
<li><em>Resize volume may cause data lost, so be carefully.</em></li>
<li><strong>Your warranty is now void. I am not responsible for bricked devices, dead SD cards, thermonuclear war, or you getting fired because the alarm app failed and anyother errors.</strong></li>
<li><strong>Do some research before you do this.</strong></li>
</ul>
<h2 id="Start"><a href="#Start" class="headerlink" title="Start"></a>Start</h2><p>To imporve my notebook’s performance, I bought a <a href="https://detail.tmall.com/item.htm?id=45106254084&amp;skuId=3277249424238&amp;areaId=320500&amp;standard=1&amp;user_id=2468908634&amp;cat_id=2&amp;is_b=1&amp;rn=f6d7634bd5d938d82ef5291775194c5c" target="_blank" rel="noopener">SSD</a> to speed up my notebook’s response speed. Before I start to usd the new inserted SSD to my notebook. The device mapper is like what below picture shows.</p>
<p><img src="/images/expand_a_logical_volume_in_lvm/before.png" alt="device mapper before"></p>
<p>As the pic shows, <strong>sda</strong> is the new <em>SSD</em>, <strong>sdb</strong> is the old hdd, it set <em>sdb3</em> as boot, set the <em>sdb5</em> as the lvm physical volume, and create a volume group named <em>archlvm</em>, in the <em>archlvm</em> volume, there four logical volumes:</p>
<ul>
<li>root. Mounted to the “root” point.</li>
<li>var. Mounted to the “/var” point.</li>
<li>swap. Used as the SWAP File.</li>
<li>home. The largest logical volume, used to store all of my files.</li>
</ul>
<p>Now what I want to do is:</p>
<ol>
<li>Let <strong>sda1</strong> be mounted to “/boot” point.</li>
<li>Migrate contents in <em>archlvm-root</em> to <em>sda2</em>, and then let <strong>sda2</strong> be mounted to “/“ point.</li>
<li>Delete logical volume <em>archlvm-root</em>, and then expand <strong>archlvm-home</strong> to use all the free space we get after delete <em>archlvm-root</em>.</li>
</ol>
<p>The following content will show you how to do this.</p>
<h2 id="Preparing"><a href="#Preparing" class="headerlink" title="Preparing"></a>Preparing</h2><p>To complete all the missions, we need a archlinux-live-usb.</p>
<ul>
<li>Download a <a href="http://mirrors.ustc.edu.cn/archlinux/iso/" target="_blank" rel="noopener">archlinux iso</a> here. If you are not in China, choose other mirrors :).</li>
<li>Create a live-USB.<ul>
<li>For UEFI Support, it’s highly recommended to use <a href="https://rufus.akeo.ie/?locale=en_US" target="_blank" rel="noopener">Rufus</a> to create the Live-USB.</li>
</ul>
</li>
</ul>
<h2 id="Migrate-“-Boot”-and-“Root”"><a href="#Migrate-“-Boot”-and-“Root”" class="headerlink" title="Migrate “/Boot” and “Root”"></a>Migrate “/Boot” and “Root”</h2><ul>
<li>Mount the partions like below:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">|--sda</span><br><span class="line">   |--sda2 /mnt/</span><br></pre></td></tr></table></figure>
<p>Then run this command in shell:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rsync -SPAaXxr --exclude=&#123;/boot,/home,/var&#125;  ./ /mnt/</span></span><br></pre></td></tr></table></figure></p>
<p>wait the command complete. Then reboot into Live-USB.</p>
<ul>
<li>Mount the partions like below:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|--sda</span><br><span class="line">   |--sda2 /mnt/</span><br><span class="line">   |--sda1 /mnt/boot</span><br><span class="line">|--sdb</span><br><span class="line">   |--sdb5</span><br><span class="line">      |--archlvm-var /mnt/var</span><br><span class="line">true  |--archlvm-home /mnt/home</span><br></pre></td></tr></table></figure>
<ul>
<li><p>turn on the swap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># swapon /dev/archlvm/swap</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Regenerate the fstab(<strong>Remember to check it, it there is something wrong in it, you may can’t boot after reboot without Live-USB</strong>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">genfstab -U -p /mnt &gt; /mnt/etc/fstab</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>A classic fstab can be found in <a href="https://wiki.archlinux.org/index.php/Fstab" target="_blank" rel="noopener">ArchLinux WIKI</a>, the UUID you may need can be get by command <strong>blkid</strong></p>
<ul>
<li><strong>arch-chroot</strong> to “/mnt”</li>
<li>Reinstall Grub to <strong>sda</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=grub</span></span><br></pre></td></tr></table></figure>
<p>After do this, we should not run <strong>grub-mkconfig</strong> immediately, because we haven’t expand the “archlvm-home”.</p>
<h2 id="Expand-Logical-Volume"><a href="#Expand-Logical-Volume" class="headerlink" title="Expand Logical Volume"></a>Expand Logical Volume</h2><p>As I said, what I want is deleting archlvm-root, and expand archlvm-home with the space the being deleted archlvm-root has. Now let’s follow below step to reach this goal.</p>
<ul>
<li>Exit the <strong>arch-chroot</strong></li>
<li>Unmount all the logical volumes in group <strong>archlvm</strong>.(<strong>CAUTION: This must be done, or you may get error.</strong>)</li>
<li>Delete <strong>archlvm-root</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># lvremove /dev/archlvm/root</span></span><br></pre></td></tr></table></figure>
<ul>
<li>expand <strong>archlvm-home</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># lvresize -l +100%FREE /dev/archlvm/home</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>After do this, the <strong>archlvm-home</strong> will take all the free space freed by delete <em>archlvm-root</em>.</p>
<ul>
<li>resizefs(<strong>CAUTION: Althrough it does not cause any error in my notebook, but I know it may cause some error in some scenarios.</strong>)<br>After we execute <em>lvresize</em>, we need to <strong>resize filesystem</strong> to let system know the change.<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># resize2fs /dev/archlvm/home</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>In somecase, the <strong>resize2fs</strong> may say that you should run command <strong>e2fsck</strong> first. If you get this, run it. (<strong>CAUTION: Althrough it does not cause any error in my notebook, but I know it may cause some error in some scenarios.</strong>)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># e2fsck -f /dev/archlvm/home</span></span><br></pre></td></tr></table></figure></p>
<p>After this complete, you can run command <strong>resize2fs</strong>.</p>
<h2 id="Complete"><a href="#Complete" class="headerlink" title="Complete"></a>Complete</h2><p>If all the steps are completed successfully, there is only one instruction we need to do——<em>grub-mkconfig</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># grub-mkconfig \-o /boot/grub/grub.cfg</span></span><br></pre></td></tr></table></figure>
<p>Reboot your computer, now we should migrate our data to SSD and expand logical volume <strong>archlvm-home</strong> successfully.</p>
<p><img src="/images/expand_a_logical_volume_in_lvm/after.png" alt="after"></p>
<p><strong>Tips:</strong></p>
<ul>
<li>Some device may have a legacy entry in EFI loader table. You can delete it in UEFI safely.</li>
<li>If you found anything wrong about device mapper, check your fstab, it is in “/etc/fstab”, to modifiy it, you’d better reboot into the Live-USB again.</li>
</ul>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">LVM</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">ArchLinux</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Linux</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/Linux/" class="article-tag-list-link color1">Linux</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Happy-Chinese-New-Year-In-2017" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/29/Happy-Chinese-New-Year-In-2017/">Happy_Chinese_New_Year_In_2017</a>
    </h1>
  

        
        <a href="/2017/01/29/Happy-Chinese-New-Year-In-2017/" class="archive-article-date">
  	<time datetime="2017-01-28T18:16:22.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2017-01-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="TL-DR"><a href="#TL-DR" class="headerlink" title="TL;DR"></a>TL;DR</h1><p>Below is written by a man that with poor English skills. Read carefully if you really want to read.(But I will say thank you if you really read all the contents below. :) )</p>
<p>Happy Chinese new year! In China, all the Chinese now say goodbye to the “Monkey Year” and step into the “year of Chicken”. Watching the Spring Festival Gala Evening provided by CCTV is a tradition for almost every Chinese. We watch the TV shows with families and share the stories that happend to each in Monkey Year.</p>
<p>For me, it is the third year that my families celebrate the new year without my grandfather, who has gone in 2014. Still feel a little sad that I won’t have chance to hear my grandfather’s voice. And I also regret that I did’t capture any short videos for my grandfather when he is alive. Now what I can do is talk with my grandfather’s portrait.</p>
<p>In this year, there are lots of things happend to me: <em>Get a intership</em>, <em>Pass the graduation thesis defense</em>, <em>Get a third rewards in Alibaba’s Security Competition</em> and also, <em>Re-Become a single doge. :)</em></p>
<p>But I am still a student now, and this may be my last school-days if I can not get a chance to pursue PhD.</p>
<p>Review the past yesr, I still have a lot of things to do but in fact I did not complete them. So in this year I will try my best to complete what I should have complete in 2016.</p>
<p>First is Tofel. If you do read what I have written above, you will know my English skil need be improved. So I set a aim that to score at least 90 points in Tofel. To realize this, I will spend 2 hours to study English every day. Include reading, listening and speaking.</p>
<p>Second is technique in computer science. There still lots of knowledge I have to study like Compiler-Engineer, Crypto-and-Decrypto, Security and Algorithms. It may be boring to study these, but I will complete  them, and I must will.</p>
<p>And the last is to have a girl friend. Yeah, may it is a dream, but may there will be a beauty like me in this year.:)</p>
<p>In the end, thank you for reading the so called English article I written above. Hope u a happy Chinese New Year, no matter whether u are a Chinese or a foreigner.:)</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">Happy New Year</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">LifeContinues</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/Life/" class="article-tag-list-link color5">Life</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Android-AntiDebug-and-Signature-Verify-Example" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/09/Android-AntiDebug-and-Signature-Verify-Example/">Android AntiDebug and Signature Verify Example</a>
    </h1>
  

        
        <a href="/2016/01/09/Android-AntiDebug-and-Signature-Verify-Example/" class="archive-article-date">
  	<time datetime="2016-01-09T13:44:08.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2016-01-09</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Reference:<a href="http://blog.csdn.net/grafx/article/details/40403577" target="_blank" rel="noopener">grafx</a>, <a href="http://burningcodes.net/%E7%94%A8jni%E5%AE%9E%E7%8E%B0apk%E7%9A%84%E5%8F%8D%E8%B0%83%E8%AF%95/" target="_blank" rel="noopener">IT Dreamer</a></p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>We can use lots of tools like apktool, baksmali, dex2jar to convert a android app to java source code easily. So now most of our developers will put the core-function in the native level(with C/C++ code) because the arm-assembly language or C pseudo code are more difficult to read than java.<br>But others can still read the native code if they really want, they can use IDA to read .so files and debug our apps dynamicly. In order to make our apps difficultly to debug dynamicly, we may will need to add some methods that can provide antidebug functions for us.</p>
<p>This aritcle will provide a simple example about how to antidebug and the sinature-verify.</p>
<p><em>PS: Recently I am helping my teacher to prepare a Android-Security Course, so I feel it is time to record something, and</em> <strong>Sorry for my poor English. (: but I think write article in English is the fast way to help me to improve my English.</strong></p>
<h1 id="Sinature-Verify"><a href="#Sinature-Verify" class="headerlink" title="Sinature Verify"></a>Sinature Verify</h1><h2 id="Java-Level"><a href="#Java-Level" class="headerlink" title="Java Level"></a>Java Level</h2><p>When we publish our apps to the app-store, we will sign apps with our private key, and put the public key into our apps, if others modify our apps, he will re-sign the apps and the public key will be changed, so we can add some code into our apps to check the sinature, if it is not same with ourselves public keys, we can let the apps to exit to prevent the modified apps do something that is harmful to users.<br>Below is the code in java level:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckSign</span> </span>&#123;</span><br><span class="line">    Context context;</span><br><span class="line">    PackageManager packageManager;</span><br><span class="line">    String strPackagename;</span><br><span class="line">    <span class="keyword">byte</span>[] byteSign;</span><br><span class="line">    String strSign;</span><br><span class="line">    Signature[] signatureArray;</span><br><span class="line"></span><br><span class="line">    CheckSign(Context context)&#123;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">checkSignNative</span><span class="params">(Context context)</span></span>;</span><br><span class="line">    <span class="comment">//The arguement is your public key's value that is deal with md5 and base64</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">checkSign</span><span class="params">(String strOriSign)</span></span>&#123;</span><br><span class="line">        checkSignNative(<span class="keyword">this</span>.context);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            packageManager = <span class="keyword">this</span>.context.getPackageManager();</span><br><span class="line">            strPackagename = <span class="keyword">this</span>.context.getPackageName();</span><br><span class="line">            signatureArray = <span class="keyword">this</span>.packageManager.getPackageInfo(strPackagename, PackageManager.GET_SIGNATURES).signatures;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*Improper validation of app signatures could lead to</span></span><br><span class="line"><span class="comment">             *issues where a malicious app submits itself to the</span></span><br><span class="line"><span class="comment">             * Play Store with both its real certificate and a</span></span><br><span class="line"><span class="comment">             * fake certificate and gains access to functionality</span></span><br><span class="line"><span class="comment">             * or information it shouldn't have due to another</span></span><br><span class="line"><span class="comment">             * application only checking for the fake certificate</span></span><br><span class="line"><span class="comment">             * and ignoring the rest. Please make sure to validate</span></span><br><span class="line"><span class="comment">             * all signatures returned by this method.</span></span><br><span class="line"><span class="comment">             * */</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; signatureArray.length; i++) &#123;</span><br><span class="line">                Log.v(<span class="string">"Verbose: "</span>, <span class="string">"Check Signatures"</span>);</span><br><span class="line">                byteSign = signatureArray[i].toByteArray();</span><br><span class="line">                byteSign = CertificateFactory.getInstance(<span class="string">"X509"</span>).generateCertificate(<span class="keyword">new</span> ByteArrayInputStream(byteSign)).getEncoded();</span><br><span class="line">                strSign = <span class="keyword">new</span> String(Base64.encode(MessageDigest.getInstance(<span class="string">"md5"</span>).digest(byteSign), <span class="number">19</span>));</span><br><span class="line">                <span class="comment">//strSign = Base64.encodeToString(MessageDigest.getInstance("md5").digest(byteSign), 19));</span></span><br><span class="line">                <span class="keyword">if</span> (!strOriSign.equals(strSign)) &#123;</span><br><span class="line">                    Log.e(<span class="string">"Error: "</span>, <span class="string">"Fake Signature"</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            Log.e(<span class="string">"Error: "</span>, <span class="string">"CheckSign Failed"</span> + e.toString());</span><br><span class="line">            System.exit(-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The java code above will do the sinature verify in java level. As what we have metioned, it is easy to be pathed by modify the smali file. So the more safy way is to do it in a .so file, which is so-called “native level”.</p>
<h2 id="Sinature-Verify-via-C"><a href="#Sinature-Verify-via-C" class="headerlink" title="Sinature Verify via C"></a>Sinature Verify via C</h2><p>To do it, we should add some code in our java code, and be careful, what this example do is simple add a native funciton that will only do the sign-check, this can be patched easily by modify the smali, too. So in the real env we should merge the code to our core-function, that means if we patched the native method call in java level, the app won’t work.<br>Below code will return the signature, you can do the verify after you get the sinature easily:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Return the String, which is generated via base64(md5(signature));</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">getSignature</span><span class="params">(JNIEnv* env, jobject obj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    jstring jstringSign;</span><br><span class="line">    jbyte *byteSign;</span><br><span class="line">    <span class="keyword">char</span> *strSign;</span><br><span class="line">    <span class="comment">// 获得Context类</span></span><br><span class="line">    jclass cls = (*env)-&gt;GetObjectClass(env, obj);</span><br><span class="line">    <span class="comment">// 得到getPackageManager方法的ID</span></span><br><span class="line">    jmethodID mid = (*env)-&gt;GetMethodID(env, cls, <span class="string">"getPackageManager"</span>, <span class="string">"()Landroid/content/pm/PackageManager;"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获得应用包的管理器</span></span><br><span class="line">    jobject pm = (*env)-&gt;CallObjectMethod(env, obj, mid);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 得到getPackageName方法的ID</span></span><br><span class="line">    mid = (*env)-&gt;GetMethodID(env, cls, <span class="string">"getPackageName"</span>, <span class="string">"()Ljava/lang/String;"</span>);</span><br><span class="line">    <span class="comment">// 获得当前应用包名</span></span><br><span class="line">    jstring packageName = (jstring)(*env)-&gt;CallObjectMethod(env, obj, mid);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获得PackageManager类</span></span><br><span class="line">    cls = (*env)-&gt;GetObjectClass(env, pm);</span><br><span class="line">    <span class="comment">// 得到getPackageInfo方法的ID</span></span><br><span class="line">    mid  = (*env)-&gt;GetMethodID(env, cls, <span class="string">"getPackageInfo"</span>, <span class="string">"(Ljava/lang/String;I)Landroid/content/pm/PackageInfo;"</span>);</span><br><span class="line">    <span class="comment">// 获得应用包的信息</span></span><br><span class="line">    jobject packageInfo = (*env)-&gt;CallObjectMethod(env, pm, mid, packageName, <span class="number">0x40</span>); <span class="comment">//GET_SIGNATURES = 64;</span></span><br><span class="line">    <span class="comment">// 获得PackageInfo 类</span></span><br><span class="line">    cls = (*env)-&gt;GetObjectClass(env, packageInfo);</span><br><span class="line">    <span class="comment">// 获得签名数组属性的ID</span></span><br><span class="line">    jfieldID fid = (*env)-&gt;GetFieldID(env, cls, <span class="string">"signatures"</span>, <span class="string">"[Landroid/content/pm/Signature;"</span>);</span><br><span class="line">    <span class="comment">// 得到签名数组</span></span><br><span class="line">    jobjectArray signatures = (jobjectArray)(*env)-&gt;GetObjectField(env, packageInfo, fid);</span><br><span class="line">    <span class="comment">// 得到签名</span></span><br><span class="line">    jobject sign = (*env)-&gt;GetObjectArrayElement(env, signatures, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获得Signature类</span></span><br><span class="line">    cls = (*env)-&gt;GetObjectClass(env, sign);</span><br><span class="line">    <span class="comment">//得到ByteSign</span></span><br><span class="line">    mid = (*env)-&gt;GetMethodID(env, cls, <span class="string">"toByteArray"</span>, <span class="string">"()[B"</span>);</span><br><span class="line">    byteSign = (*env)-&gt;CallObjectMethod(env, sign, mid);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据Byte生成md5消息摘要</span></span><br><span class="line">    cls  = (*env)-&gt;FindClass(env, <span class="string">"java/security/MessageDigest"</span>);</span><br><span class="line">    mid = (*env)-&gt;GetStaticMethodID(env, cls, <span class="string">"getInstance"</span>, <span class="string">"(Ljava/lang/String;)Ljava/security/MessageDigest;"</span>);</span><br><span class="line">    jobject jmd5 = (*env)-&gt;CallStaticObjectMethod(env, cls, mid, (*env)-&gt;NewStringUTF(env, <span class="string">"md5"</span>));</span><br><span class="line">    mid = (*env)-&gt;GetMethodID(env, cls, <span class="string">"update"</span>, <span class="string">"([B)V"</span>);</span><br><span class="line">    (*env)-&gt;CallVoidMethod(env, jmd5, mid, byteSign);</span><br><span class="line">    mid = (*env)-&gt;GetMethodID(env, cls, <span class="string">"digest"</span>, <span class="string">"()[B"</span>);</span><br><span class="line">    <span class="comment">//md5散列后的byte[]</span></span><br><span class="line">    byteSign = (*env)-&gt;CallObjectMethod(env, jmd5, mid);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//生成Base64后的String</span></span><br><span class="line">    cls = (*env)-&gt;FindClass(env, <span class="string">"android/util/Base64"</span>);</span><br><span class="line">    mid = (*env)-&gt;GetStaticMethodID(env, cls, <span class="string">"encodeToString"</span>, <span class="string">"([BI)Ljava/lang/String;"</span>);</span><br><span class="line">    <span class="comment">//得到base64后的String</span></span><br><span class="line">    jstringSign = (*env)-&gt;CallStaticObjectMethod(env, cls, mid, byteSign, <span class="number">19</span>);</span><br><span class="line">    strSign = (*env)-&gt;GetStringUTFChars(env, jstringSign, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="comment">//LOGW("%s", strSign);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> strSign;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The code above will call the java function via relfcetion, and the second arguement is a Context object that can be passed by declare a java method like<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">native</span> [Return Type] FunctionName(Context, ...);</span><br></pre></td></tr></table></figure></p>
<h1 id="Antidebug"><a href="#Antidebug" class="headerlink" title="Antidebug"></a>Antidebug</h1><p>Simplly, we can start a new process via the fork(), the new process will check the parent’s <strong>/proc/[PID]/status</strong> file to see whether the <strong>TracerPid</strong> is 0, if not, kill the parent and then exit. Also, we should prevent others to debug the child process via dynamic debuging, we can let the child process <a href="https://en.wikipedia.org/wiki/Ptrace" target="_blank" rel="noopener"><strong>ptrace</strong></a> itself.</p>
<p>The code below will provide antidebug function:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">antiDebug</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> bufsize = <span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">char</span> filename[bufsize];</span><br><span class="line">    <span class="keyword">char</span> line[bufsize];</span><br><span class="line">    <span class="keyword">int</span> pid = getpid();</span><br><span class="line">    <span class="built_in">sprintf</span>(filename, <span class="string">"/proc/%d/status"</span>, pid);</span><br><span class="line">    FILE* fd;</span><br><span class="line">    <span class="comment">//Child Proc check the parent's status</span></span><br><span class="line">    <span class="keyword">if</span> (fork() == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> pt;</span><br><span class="line">        pt = ptrace(PTRACE_TRACEME, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">//Child Proc anti ptrace</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">            fd = fopen(filename, <span class="string">"r"</span>);</span><br><span class="line">            <span class="keyword">if</span> (fd != <span class="literal">NULL</span>) &#123;</span><br><span class="line">                <span class="keyword">while</span> (fgets(line, bufsize, fd)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">strncmp</span>(line, <span class="string">"TracerPid"</span>, <span class="number">9</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="keyword">int</span> statue = atoi(&amp;line[<span class="number">10</span>]);</span><br><span class="line">                        <span class="keyword">if</span> (statue != <span class="number">0</span>) &#123;</span><br><span class="line">                            fclose(fd);</span><br><span class="line">                            <span class="keyword">int</span> ret = kill(pid, SIGKILL);</span><br><span class="line">                            <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                fclose(fd);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">truetruetruetrue;</span><br><span class="line">            &#125;</span><br><span class="line">            sleep(<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>To do something more, you can also create a marco which will do<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">fd = fopen(filename, <span class="string">"r"</span>);</span><br><span class="line">   <span class="keyword">if</span> (fd != <span class="literal">NULL</span>) &#123;</span><br><span class="line">   	<span class="keyword">while</span> (fgets(line, bufsize, fd)) &#123;</span><br><span class="line">       	<span class="keyword">if</span> (<span class="built_in">strncmp</span>(line, <span class="string">"TracerPid"</span>, <span class="number">9</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">           	<span class="keyword">int</span> statue = atoi(&amp;line[<span class="number">10</span>]);</span><br><span class="line">           	<span class="keyword">if</span> (statue != <span class="number">0</span>) &#123;</span><br><span class="line">           		fclose(fd);</span><br><span class="line">           		<span class="keyword">int</span> ret = kill(pid, SIGKILL);</span><br><span class="line">          		 	<span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">          		&#125;</span><br><span class="line">           	<span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">true&#125;</span><br><span class="line">   &#125;</span><br><span class="line">fclose(fd);</span><br></pre></td></tr></table></figure></p>
<p>and put it in a lot of places in your c source code, to add the difficulty of reversing apps.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>In this article we provide a simple example about antidebug and signCheck, it can not prevent others to reverse our apps completely, but it can add the difficulty in reversing. Hope this article can help someone. :)</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">AntiDebug</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">Signature Verify</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/Android/" class="article-tag-list-link color3">Android</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-IDF-CN-Practice-01" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/30/IDF-CN-Practice-01/">IDF.CN Practice 01</a>
    </h1>
  

        
        <a href="/2015/12/30/IDF-CN-Practice-01/" class="archive-article-date">
  	<time datetime="2015-12-30T14:12:08.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-12-30</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="0x1-Preparation"><a href="#0x1-Preparation" class="headerlink" title="0x1 Preparation"></a>0x1 Preparation</h1><p>既然决定要做，那就加油，写在开头，打好基础，加油吧。<br>Exia，斩获未来。。</p>
<h1 id="0x2-Start"><a href="#0x2-Start" class="headerlink" title="0x2 Start"></a>0x2 Start</h1><h2 id="一、牛刀小试"><a href="#一、牛刀小试" class="headerlink" title="一、牛刀小试"></a>一、牛刀小试</h2><h3 id="被改错的密码"><a href="#被改错的密码" class="headerlink" title="被改错的密码"></a>被改错的密码</h3><p>从前有一个熊孩子入侵了一个网站的数据库，找到了管理员密码，手一抖在数据库中修改了一下，现在的密码变成了 cca9cc444e64c8116a30la00559c042b4，那个熊孩子其实就是我！肿么办求解！在线等，挺急的。。</p>
<p><em>看起来挺像md5,直接拿去在线破，结果提示有问题，再一看，长度有问题，md5是32位哈希，这玩意33位，用python生成去掉其中某个字符的序列，然后再一个个在线破，发现是<strong>cca9cc444e64c8116a30a00559c042b4</strong>，解出来是idf，所以flag是wctf{idf}</em></p>
<hr>
<h3 id="啥"><a href="#啥" class="headerlink" title="啥"></a>啥</h3><p>题目就是一张图片，bless打开看hex，在底部找到flag：wctf{mianwubiaoqing__}</p>
<hr>
<h3 id="ASCII码而已"><a href="#ASCII码而已" class="headerlink" title="ASCII码而已"></a>ASCII码而已</h3><p>明显一看是unicode，找个在线转换，flag为wctf{moremore_weibo_fans}</p>
<hr>
<h3 id="摩斯密码"><a href="#摩斯密码" class="headerlink" title="摩斯密码"></a>摩斯密码</h3><p>一段morsecode<br>–  —  .-.  …  . -.-.  —  -..  .<br>在线解一下，flag为wctf{morsecode}</p>
<hr>
<h3 id="聪明的小羊"><a href="#聪明的小羊" class="headerlink" title="聪明的小羊"></a>聪明的小羊</h3><p><em>一只小羊跳过了栅栏，两只小样跳过了栅栏，一坨小羊跳过了栅栏…<br>tn c0afsiwal kes,hwit1r  g,npt  ttessfu}ua u  hmqik e {m,  n huiouosarwCniibecesnren.</em></p>
<p>看题目就想到古典加密，既然是栅栏，那就栅栏密码吧，正好带学一下栅栏密码，就写了个python的加解码脚本，跑一下看到flag:wctf{C01umnar}</p>
<h2 id="二、包罗万象-MISC"><a href="#二、包罗万象-MISC" class="headerlink" title="二、包罗万象 MISC"></a>二、包罗万象 MISC</h2><h3 id="图片里的英语"><a href="#图片里的英语" class="headerlink" title="图片里的英语"></a>图片里的英语</h3><p>给了一张小李，binwalk一下。看到有个rar，dd提取出来，解压，得到一长flag，恩，没错，就是那张赵本山的图片，may the force be with you，然后首字母大写，wctf{Mtfbwy}</p>
<hr>
<h3 id="抓到一只苍蝇"><a href="#抓到一只苍蝇" class="headerlink" title="抓到一只苍蝇"></a>抓到一只苍蝇</h3><p>给了一个pcapng网络dump包，根据他说的内容，和包名带有fly，搜索包内容，找下字符串fly，成功找到，发现是上传了一个附件fly.rar,分成了5个包上传，第一个post指出fly.rar大小为525701，接着5个包都是传向ftn开头服务器，所以猜测是附件内容，前个都是131436大小，最后一个1777，（131436×4 + 1777 - 525701） / 5 = 364，所以每个包开头364部分为分包后的包头，dd导出内容，skip掉头364字节，然后cat成fly.rar，比较下post里给的md5,一样。</p>
<p>解压工具打开，提示文件损坏，看上去因该不是正常的加密，而且也根本没有其他密码的信息，推测可能改了文件头，bless修改加密位（第24个字节改为0x80）：</p>
<p>解压得到一个flag.txt，打开发现不行，binwalk一看是个pe。。。不过里面有png，而且很多60x60的，但有一个280x280的，dd解出来，打开是一张二维码，扫一下，flag为:flag{m1Sc_oxO2_Fly}，不过说没改格式，额，所以应该是wctf{m1Sc_oxO2_Fly}</p>
<h2 id="三、初探乾坤-PPC"><a href="#三、初探乾坤-PPC" class="headerlink" title="三、初探乾坤 PPC"></a>三、初探乾坤 PPC</h2><h3 id="简单编程-字符统计"><a href="#简单编程-字符统计" class="headerlink" title="简单编程-字符统计"></a>简单编程-字符统计</h3><p>给了一串字符串，让统计个数，妥妥的python，count函数直接搞定。直接提交，发现有坑，仔细看了下题目是要求2秒内搞定，那就只能自动接受内容然后发送post请求了</p>
<p>写个python脚本跑一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment">#url and regex for get string to count</span></span><br><span class="line">url = <span class="string">'http://ctf.idf.cn/game/pro/37/index.php'</span></span><br><span class="line">regex = <span class="string">r'&lt;hr /&gt;(.+)&lt;hr /&gt;'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#get the string and remember the cookie</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">requestString</span><span class="params">()</span>:</span></span><br><span class="line">    respon = requests.get(url);</span><br><span class="line">    strTarget = respon.text</span><br><span class="line">    strTarget = strTarget.replace(<span class="string">"\n"</span>, <span class="string">""</span>)</span><br><span class="line">    strTarget = strTarget.replace(<span class="string">"\r"</span>, <span class="string">""</span>)</span><br><span class="line">    strTarget = strTarget.replace(<span class="string">"\t"</span>, <span class="string">""</span>)</span><br><span class="line">    webCookie = respon.cookies</span><br><span class="line">    strTarget = re.findall(regex, strTarget)</span><br><span class="line">    <span class="keyword">return</span> strTarget, webCookie</span><br><span class="line"></span><br><span class="line"><span class="comment">#count the words num</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genAnwser</span><span class="params">(strTarget)</span>:</span></span><br><span class="line">    w, o, l, d, y = <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> strTarget:</span><br><span class="line">        <span class="keyword">if</span> c == <span class="string">"w"</span>:</span><br><span class="line">            w += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> c == <span class="string">"o"</span>:</span><br><span class="line">            o += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> c == <span class="string">"l"</span>:</span><br><span class="line">            l += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> c == <span class="string">"d"</span>:</span><br><span class="line">            d += <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> c == <span class="string">"y"</span>:</span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">    strAnwser = str(w) + str(o) + str(l) + str(d) + str(y)</span><br><span class="line">    <span class="keyword">return</span> strAnwser</span><br><span class="line"></span><br><span class="line"><span class="comment">#post the anwser with the cookie we get via requestString()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">postAnwser</span><span class="params">(strAnwser, webCookie)</span>:</span></span><br><span class="line">    data = &#123;&#125;</span><br><span class="line">    data[<span class="string">'anwser'</span>] = strAnwser</span><br><span class="line">    respon = requests.post(url, data = data, cookies = webCookie)</span><br><span class="line">    <span class="keyword">print</span> (respon.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    result = requestString()</span><br><span class="line">    strTarget = result[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    webCookie = result[<span class="number">1</span>]</span><br><span class="line">    strAnwser = genAnwser(strTarget)</span><br><span class="line">    postAnwser(strAnwser, webCookie)</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="谁是卧底"><a href="#谁是卧底" class="headerlink" title="谁是卧底"></a>谁是卧底</h3><p>给了一个大文本串，打开看基本上都是乱字符，根据题意，大部分人都市文盲，卧底有点姿势，所以找个字典去统计下出现单词的地方，然后打印出最密集出现的部分，在里面找到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bananjpywlqclassifyubcjesqtqyjhazbornndomhfchvlc</span><br><span class="line">what will you see if you throw the butter out the window</span><br><span class="line">wzqmtwmyjutipvqetrsshyosypzydevelopponaxoezspdespairkuoqi</span><br></pre></td></tr></table></figure>
<p>第二行是一句话，字面意思，丟块黄油你会看到啥，当然黄油飞啊，butter fly。。。就是butterfly，所以是wctf{butterfly}</p>
<hr>
<h3 id="Fuck-your-brain"><a href="#Fuck-your-brain" class="headerlink" title="Fuck your brain"></a>Fuck your brain</h3><p>Brain Fuck编码，直接找个在线解析器解析一下OK。<br>WCTF{Br31nF4ck}</p>
<h2 id="倒行逆施"><a href="#倒行逆施" class="headerlink" title="倒行逆施"></a>倒行逆施</h2><hr>
<h3 id="Net逆向第一题"><a href="#Net逆向第一题" class="headerlink" title=".Net逆向第一题"></a>.Net逆向第一题</h3><p>如题目说，应该是个简单的.Net逆向，用ILSpy查看代码，是个典型的des加密，key = “wctf{wol}”<br>iv = “dy_crack}”，然后加密后的结果在base64编码下和已有字符串<strong>fOCPTVF0diO+B0IMXntkPoRJDUj5CCsT</strong>进行比较。<br>根据这个过程逆推即可，写个python脚本跑下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">key64 = <span class="string">'wctf&#123;wol'</span></span><br><span class="line">iv64 = <span class="string">'dy_crack'</span></span><br><span class="line">encryptedString = <span class="string">'fOCPTVF0diO+B0IMXntkPoRJDUj5CCsT'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myDecrypt</span><span class="params">(key, iv, arg)</span>:</span></span><br><span class="line">    k = bytes(key.encode(<span class="string">"ASCII"</span>))</span><br><span class="line">    i = bytes(iv.encode(<span class="string">"ASCII"</span>))</span><br><span class="line">    mydes = DES.new(k, DES.MODE_CBC, i)</span><br><span class="line">    rarg = base64.b64decode(arg.encode(<span class="string">"ASCII"</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> rarg:</span><br><span class="line">        print(<span class="string">'0x%x'</span> %i, end= <span class="string">' '</span>)</span><br><span class="line">    print(end=<span class="string">'\n'</span>)</span><br><span class="line">    strRes = mydes.decrypt(rarg)</span><br><span class="line">    print(strRes)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    myDecrypt(key64, iv64, encryptedString)</span><br></pre></td></tr></table></figure></p>
<p>最终结果是<strong>wctf{dotnet_crackme1}</strong>， 没怎么写过C#，这里有个坑是C#的createEncrypter()可以接受byte[] iv不为8 bytes，但是python里除了DES.MODE_ECB外都不可以，刚开始用ECB解出来不对，换回ECB会提示iv应该是8 bytes，就猜可能C#有做截断处理？于是把上面代码里的iv64最后的那个’}’去掉，再跑一下果然OK。。当然C#不熟，不知道理解的对不对。。。</p>
<hr>
<h3 id="简单的PE文件逆向"><a href="#简单的PE文件逆向" class="headerlink" title="简单的PE文件逆向"></a>简单的PE文件逆向</h3><p>和题目说的一样，一道简单的PE逆向，首先运行下，命令行输入flag<br>丢ida， shift f12 查看string，有个<br><code>swfxc{gdv}fwfctslydRddoepsckaNDMSRITPNsmr1_=2cdsef66246087138</code>，是个字符数组</p>
<p><img src="/images/idf_cn_practice_1/pe1.jpg" alt="pe1"></p>
<p>查找引用，在<strong>sub_4113A0</strong>里,tab查看反汇编代码，主体是个循环，和输入进行了17次判断，然后再继续用一个if判断5次，只要有一个不同就让v13为1,继而输出<strong>Wrong</strong></p>
<p><img src="/images/idf_cn_practice_1/pe2.jpg" alt="pe2"></p>
<p>继续看循环内如何从字符串数组取值，index通过<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(&amp;v14 + i)</span><br></pre></td></tr></table></figure></p>
<p>来取值，再看函数开头，从v14到v35,刚好有超过17个连续的变量可用，再看前面的代码，有从v14到v35的初始化：</p>
<p><img src="/images/idf_cn_practice_1/pe3.jpg" alt="pe3"></p>
<p>这里把v14到v30的值保存，为<br><strong>(0x1, 0x4, 0xe, 0xa, 0x5, 0x24, 0x17, 0x2a, 0x0d, 0x13, 0x1c, 0x0d, 0x1b, 0x27, 0x30, 0x29, 0x2a)</strong>，<br>因为向下在if里还有5次比较，把这五次的值也保存，<strong>(49, 48, 50, 52, 125)</strong>。<br>接着动态运行确认下，在如下图里的位置下断：</p>
<p><img src="/images/idf_cn_practice_1/pe4.jpg" alt="pe4"></p>
<p>运行几次，查看eax的值，和上面列出的相同，可知上述序列确实是用来从那个字符数组里取值的，所以最后的5次比较也是字符，因为接着v37后是四个chr类型，所以其实真正应该是一个v37[22]的数组。如此依赖用脚本跑一把。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">strSrc = <span class="string">'swfxc&#123;gdv&#125;fwfctslydRddoepsckaNDMSRITPNsmr1_=2cdsef66246087138'</span></span><br><span class="line"></span><br><span class="line">numTuple = (<span class="number">0x1</span>, <span class="number">0x4</span>, <span class="number">0xe</span>, <span class="number">0xa</span>, <span class="number">0x5</span>, <span class="number">0x24</span>, <span class="number">0x17</span>, <span class="number">0x2a</span>, <span class="number">0x0d</span>, <span class="number">0x13</span>, <span class="number">0x1c</span>, <span class="number">0x0d</span>, <span class="number">0x1b</span>, <span class="number">0x27</span>, <span class="number">0x30</span>, <span class="number">0x29</span>, <span class="number">0x2a</span>)</span><br><span class="line"></span><br><span class="line">numChar = (<span class="number">49</span>, <span class="number">48</span>, <span class="number">50</span>, <span class="number">52</span>, <span class="number">125</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">doTheGenerate</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> numTuple:</span><br><span class="line">        print(strSrc[i], end=<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> numChar:</span><br><span class="line">        print(chr(i), end=<span class="string">''</span>)</span><br><span class="line">    print(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    doTheGenerate()</span><br></pre></td></tr></table></figure>
<p>得到结果wctf{Pe_cRackme1_1024}</p>
<hr>
<h3 id="简单的ELF逆向"><a href="#简单的ELF逆向" class="headerlink" title="简单的ELF逆向"></a>简单的ELF逆向</h3><p>题目给的是一个x86-64的ELF文件，跑一下和简单PE类似，要输入正确的flag，错误就打印”u r wrong。”<br>丢IDA反一下，ida对x64支持不太好，pseudo code显示还有点不爽（–！），不过幸好不太复杂，对着汇编还是能看的:</p>
<p><img src="/images/idf_cn_practice_1/elf1.jpg" alt="elf1"><br><img src="/images/idf_cn_practice_1/elf2.jpg" alt="elf2"></p>
<p>从上图看到v8到v15是8个int64_t的类型，v16是个int32_t，对应汇编用两次mov dword ptr指令初始化每个变量的低4bytes和个高4bytes:</p>
<p><img src="/images/idf_cn_practice_1/elf3.jpg" alt="elf3"><br><img src="/images/idf_cn_practice_1/elf4.jpg" alt="elf4"></p>
<p>接着是程序主体，接受输入，进行判断，如果和要求不符合，v24为1，打印 u r wrong，从伪码可以看出来，输入需要是个长度为22的串，否则会把v24设为1。</p>
<p><img src="/images/idf_cn_practice_1/elf5.jpg" alt="elf5"></p>
<p>接下来看判断部分，和PE的类似，分两部分判定，for循环里判定前17个字符，用于进行判定比较的取值方法如下：</p>
<p><img src="/images/idf_cn_practice_1/elf6.jpg" alt="elf6"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">j from <span class="number">0</span> to <span class="number">16</span></span><br><span class="line">(*((DWORD *)&amp;v8 + j) - <span class="number">1</span>) / <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>按照上面方法一次和输入v17[j]里的每个字符比较，这里可以看到已经把从v8开始的这些int64_t的变量看成了一个int32_t数组，刚好v8到v15有8个int64_t，刚好是16个int32_t，在加上最后的v16刚好是17个值，所以，根据上面的截图，这17的用来计算比较值的数据分别为<strong>(0xEF, 0xC7, 0xE9, 0xCD, 0xF7, 0x8B, 0xD9, 0x8D, 0xBF, 0xD9, 0xDD, 0xB1, 0xBF, 0x87, 0xD7, 0xDB, 0xBF)</strong><br>紧接着是在if里进行5次最后的比较，用于比较的值是<strong>(48, 56, 50, 51, 125)</strong><br>综上已经知道flag计算过程，写个脚本跑出来:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">numForCalc = (<span class="number">0xEF</span>, <span class="number">0xC7</span>, <span class="number">0xE9</span>, <span class="number">0xCD</span>, <span class="number">0xF7</span>, <span class="number">0x8B</span>, <span class="number">0xD9</span>, <span class="number">0x8D</span>, <span class="number">0xBF</span>, <span class="number">0xD9</span>, <span class="number">0xDD</span>, <span class="number">0xB1</span>, <span class="number">0xBF</span>, <span class="number">0x87</span>, <span class="number">0xD7</span>, <span class="number">0xDB</span>, <span class="number">0xBF</span>)</span><br><span class="line">numForLastFive = (<span class="number">48</span>, <span class="number">56</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">125</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genTheFlag</span><span class="params">()</span>:</span></span><br><span class="line">    resultLst = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> numForCalc:</span><br><span class="line">        resultLst.append(chr((i - <span class="number">1</span>) // <span class="number">2</span>)) <span class="comment">#落地除</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> numForLastFive:</span><br><span class="line">        resultLst.append(chr(i))</span><br><span class="line">    print(str(<span class="string">''</span>).join(resultLst))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    genTheFlag()</span><br></pre></td></tr></table></figure>
<p>结果是<strong>wctf{ElF_lnX_Ckm_0823}</strong></p>
<hr>
<h3 id="python-ByteCode"><a href="#python-ByteCode" class="headerlink" title="python ByteCode"></a>python ByteCode</h3><p>看题目就知道，工具用上，<strong>uncompyle2</strong>（如果是exe可能还要用<strong>unpy2exe</strong>），得到下面的py脚本代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2015.12.31 18:17:37 CST</span></span><br><span class="line"><span class="comment">#Embedded file name: d:/idf.py</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(key, seed, string)</span>:</span></span><br><span class="line">    rst = []</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> string:</span><br><span class="line">        rst.append((ord(v) + seed ^ ord(key[seed])) % <span class="number">255</span>)</span><br><span class="line">        seed = (seed + <span class="number">1</span>) % len(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> rst</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Welcome to idf's python crackme"</span></span><br><span class="line">    flag = input(<span class="string">'Enter the Flag: '</span>)</span><br><span class="line">    KEY1 = <span class="string">'Maybe you are good at decryptint Byte Code, have a try!'</span></span><br><span class="line">    KEY2 = [<span class="number">124</span>,</span><br><span class="line">     <span class="number">48</span>,</span><br><span class="line">     <span class="number">52</span>,</span><br><span class="line">     <span class="number">59</span>,</span><br><span class="line">     <span class="number">164</span>,</span><br><span class="line">     <span class="number">50</span>,</span><br><span class="line">     <span class="number">37</span>,</span><br><span class="line">     <span class="number">62</span>,</span><br><span class="line">     <span class="number">67</span>,</span><br><span class="line">     <span class="number">52</span>,</span><br><span class="line">     <span class="number">48</span>,</span><br><span class="line">     <span class="number">6</span>,</span><br><span class="line">     <span class="number">1</span>,</span><br><span class="line">     <span class="number">122</span>,</span><br><span class="line">     <span class="number">3</span>,</span><br><span class="line">     <span class="number">22</span>,</span><br><span class="line">     <span class="number">72</span>,</span><br><span class="line">     <span class="number">1</span>,</span><br><span class="line">     <span class="number">1</span>,</span><br><span class="line">     <span class="number">14</span>,</span><br><span class="line">     <span class="number">46</span>,</span><br><span class="line">     <span class="number">27</span>,</span><br><span class="line">     <span class="number">232</span>]</span><br><span class="line">    en_out = encrypt(KEY1, <span class="number">5</span>, flag)</span><br><span class="line">    <span class="keyword">if</span> KEY2 == en_out:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'You Win'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Try Again !'</span></span><br><span class="line">+++ okay decompyling crackme.pyc</span><br><span class="line"><span class="comment"># decompiled 1 files: 1 okay, 0 failed, 0 verify failed</span></span><br><span class="line"><span class="comment"># 2015.12.31 18:17:37 CST</span></span><br></pre></td></tr></table></figure></p>
<p>把输入存到flag， 然后通过encrypt(KEY1, 5, flag)加密，再和KEY2进行比较，相同即可，从encrypt()函数可以知道输入和KEY2长度相同，再按照encrypt()的思路反过来算一遍即可。。。<br>结果发现，尼码想简单了。。根本不行。。。怎么算带乱码。。只能爆破了。。。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">KEY1 = <span class="string">'Maybe you are good at decryptint Byte Code, have a try!'</span></span><br><span class="line">KEY2 = (<span class="number">124</span>, <span class="number">48</span>, <span class="number">52</span>, <span class="number">59</span>, <span class="number">164</span>, <span class="number">50</span>, <span class="number">37</span>, <span class="number">62</span>, <span class="number">67</span>, <span class="number">52</span>, <span class="number">48</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">122</span>, <span class="number">3</span>, <span class="number">22</span>, <span class="number">72</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">46</span>, <span class="number">27</span>, <span class="number">232</span>)</span><br><span class="line">SEED = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deCrack</span><span class="params">(KEY1, KEY2, SEED)</span>:</span></span><br><span class="line">    resultList = []</span><br><span class="line">    resultStr = <span class="string">''</span></span><br><span class="line">    tmp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> KEY2:</span><br><span class="line">        <span class="comment">#尽量缩小范围吧，可见字符是从33到126</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">33</span>, <span class="number">127</span>):</span><br><span class="line">            <span class="keyword">if</span> v == ((i + SEED ^ ord(KEY1[SEED])) % <span class="number">255</span>):</span><br><span class="line">                resultList.append(chr(i))</span><br><span class="line">        SEED = (SEED + <span class="number">1</span>) % len(KEY1)</span><br><span class="line">    resultStr = resultStr.join(resultList)</span><br><span class="line">    print()</span><br><span class="line">    <span class="keyword">return</span> resultStr</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    rst = deCrack(KEY1, KEY2, SEED)</span><br><span class="line">    print(rst)</span><br></pre></td></tr></table></figure></p>
<p>拿到flag，<strong>WCTF{ILOVEPYTHONSOMUCH}</strong></p>
<h3 id="BreakPoint"><a href="#BreakPoint" class="headerlink" title="BreakPoint"></a>BreakPoint</h3><p>给了一个ELF32的文件，行为和之前的一样，输入flag，正确即可。<br>丢IDA，程序逻辑很明显：</p>
<ul>
<li>打印提示字符</li>
<li>接收输入</li>
<li>利用提示字符的地址和main的地址计算了一个值放v0和v4</li>
<li>在一个if里进行比较，比较的值都是写死在程序里</li>
</ul>
<p>关键逻辑和对应数据如图：</p>
<p><img src="/images/idf_cn_practice_1/bk1.jpg" alt="bk1"><br><img src="/images/idf_cn_practice_1/bk2.jpg" alt="bk2"><br><img src="/images/idf_cn_practice_1/bk3.jpg" alt="bk3"></p>
<p>ida看下main地址就知道v0的值肯定会在第一个if的do-while里算出来，需要注意的是，这里不能gdb去调试，因为gdb下断是用 int $0x3，软中断的机制是在断点处把代码替换成int $0x3，但是计算的时候会把整个程序从main（<strong>0x80483B0</strong>）到字符串（<strong>0x804872A</strong>）的数据拿来用于计算v0,所以只能把这些数据抠出来单独跑v0的值，跑到后下面就OK了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">u_int8_t</span> v1[] = &#123;<span class="number">0x55</span>, <span class="number">0x89</span>, <span class="number">0xE5</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x53</span>, <span class="number">0x83</span>, <span class="number">0xE4</span>, <span class="number">0xF0</span>, <span class="number">0x83</span>, <span class="number">0xEC</span>, <span class="number">0x20</span>, <span class="number">0xA1</span>, <span class="number">0x00</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xC7</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0xF0</span>, <span class="number">0x86</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x04</span>, <span class="number">0xE8</span>, <span class="number">0x8F</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC7</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xC7</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x0B</span>, <span class="number">0x87</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0xBB</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x8B</span>, <span class="number">0x1D</span>, <span class="number">0x00</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x89</span>, <span class="number">0xD8</span>, <span class="number">0x2D</span>, <span class="number">0xB0</span>, <span class="number">0x83</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x81</span>, <span class="number">0xFB</span>, <span class="number">0xB0</span>, <span class="number">0x83</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x76</span>, <span class="number">0x1C</span>, <span class="number">0xBA</span>, <span class="number">0xB0</span>, <span class="number">0x83</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x90</span>, <span class="number">0x89</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0xF9</span>, <span class="number">0x1B</span>, <span class="number">0xC1</span>, <span class="number">0xE0</span>, <span class="number">0x05</span>, <span class="number">0x31</span>, <span class="number">0xC8</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x0A</span>, <span class="number">0x83</span>, <span class="number">0xC2</span>, <span class="number">0x01</span>, <span class="number">0x31</span>, <span class="number">0xC8</span>, <span class="number">0x39</span>, <span class="number">0xDA</span>, <span class="number">0x75</span>, <span class="number">0xEA</span>, <span class="number">0x89</span>, <span class="number">0xC2</span>, <span class="number">0x32</span>, <span class="number">0x15</span>, <span class="number">0x08</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x15</span>, <span class="number">0xF0</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x1C</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0x38</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x54</span>, <span class="number">0x24</span>, <span class="number">0x1D</span>, <span class="number">0x89</span>, <span class="number">0xD1</span>, <span class="number">0x32</span>, <span class="number">0x0D</span>, <span class="number">0x09</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x0D</span>, <span class="number">0xF1</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x4C</span>, <span class="number">0x24</span>, <span class="number">0x1E</span>, <span class="number">0x89</span>, <span class="number">0xCB</span>, <span class="number">0x32</span>, <span class="number">0x1D</span>, <span class="number">0x0A</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xF2</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x7C</span>, <span class="number">0x24</span>, <span class="number">0x1F</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x0B</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xFB</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xF3</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0xEC</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x0C</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xC3</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xF4</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0xD7</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x0D</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xD3</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xF5</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0xC2</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x0E</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xCB</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xF6</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0xAD</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x0F</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xFB</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xF7</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0x98</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x10</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xC3</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x85</span>, <span class="number">0x83</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x11</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xD3</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xF9</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x12</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xCB</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xFA</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x75</span>, <span class="number">0x61</span>, <span class="number">0x0F</span>, <span class="number">0xB6</span>, <span class="number">0x1D</span>, <span class="number">0x13</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x31</span>, <span class="number">0xFB</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xFB</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x75</span>, <span class="number">0x50</span>, <span class="number">0x33</span>, <span class="number">0x05</span>, <span class="number">0x14</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x05</span>, <span class="number">0xFC</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x75</span>, <span class="number">0x42</span>, <span class="number">0x32</span>, <span class="number">0x15</span>, <span class="number">0x15</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x15</span>, <span class="number">0xFD</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x75</span>, <span class="number">0x34</span>, <span class="number">0x32</span>, <span class="number">0x0D</span>, <span class="number">0x16</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x0D</span>, <span class="number">0xFE</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x75</span>, <span class="number">0x26</span>, <span class="number">0x89</span>, <span class="number">0xFB</span>, <span class="number">0x32</span>, <span class="number">0x1D</span>, <span class="number">0x17</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x3A</span>, <span class="number">0x1D</span>, <span class="number">0xFF</span>, <span class="number">0x98</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x75</span>, <span class="number">0x16</span>, <span class="number">0xC7</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x0E</span>, <span class="number">0x87</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0x14</span>, <span class="number">0xFE</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x8D</span>, <span class="number">0x65</span>, <span class="number">0xF4</span>, <span class="number">0x31</span>, <span class="number">0xC0</span>, <span class="number">0x5B</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x5D</span>, <span class="number">0xC3</span>, <span class="number">0xC7</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x1C</span>, <span class="number">0x87</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0xFE</span>, <span class="number">0xFD</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xEB</span>, <span class="number">0xE8</span>, <span class="number">0x31</span>, <span class="number">0xED</span>, <span class="number">0x5E</span>, <span class="number">0x89</span>, <span class="number">0xE1</span>, <span class="number">0x83</span>, <span class="number">0xE4</span>, <span class="number">0xF0</span>, <span class="number">0x50</span>, <span class="number">0x54</span>, <span class="number">0x52</span>, <span class="number">0x68</span>, <span class="number">0x60</span>, <span class="number">0x86</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x68</span>, <span class="number">0x70</span>, <span class="number">0x86</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x68</span>, <span class="number">0xB0</span>, <span class="number">0x83</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0xFB</span>, <span class="number">0xFD</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xF4</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0xB8</span>, <span class="number">0x07</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x2D</span>, <span class="number">0x04</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x83</span>, <span class="number">0xF8</span>, <span class="number">0x06</span>, <span class="number">0x77</span>, <span class="number">0x02</span>, <span class="number">0xF3</span>, <span class="number">0xC3</span>, <span class="number">0xB8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x85</span>, <span class="number">0xC0</span>, <span class="number">0x74</span>, <span class="number">0xF5</span>, <span class="number">0x55</span>, <span class="number">0x89</span>, <span class="number">0xE5</span>, <span class="number">0x83</span>, <span class="number">0xEC</span>, <span class="number">0x18</span>, <span class="number">0xC7</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x04</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xFF</span>, <span class="number">0xD0</span>, <span class="number">0xC9</span>, <span class="number">0xC3</span>, <span class="number">0x90</span>, <span class="number">0x8D</span>, <span class="number">0x74</span>, <span class="number">0x26</span>, <span class="number">0x00</span>, <span class="number">0xB8</span>, <span class="number">0x04</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x2D</span>, <span class="number">0x04</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xC1</span>, <span class="number">0xF8</span>, <span class="number">0x02</span>, <span class="number">0x89</span>, <span class="number">0xC2</span>, <span class="number">0xC1</span>, <span class="number">0xEA</span>, <span class="number">0x1F</span>, <span class="number">0x01</span>, <span class="number">0xD0</span>, <span class="number">0xD1</span>, <span class="number">0xF8</span>, <span class="number">0x75</span>, <span class="number">0x02</span>, <span class="number">0xF3</span>, <span class="number">0xC3</span>, <span class="number">0xBA</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x85</span>, <span class="number">0xD2</span>, <span class="number">0x74</span>, <span class="number">0xF5</span>, <span class="number">0x55</span>, <span class="number">0x89</span>, <span class="number">0xE5</span>, <span class="number">0x83</span>, <span class="number">0xEC</span>, <span class="number">0x18</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0x04</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xFF</span>, <span class="number">0xD2</span>, <span class="number">0xC9</span>, <span class="number">0xC3</span>, <span class="number">0x90</span>, <span class="number">0x8D</span>, <span class="number">0xB4</span>, <span class="number">0x26</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x3D</span>, <span class="number">0x04</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x13</span>, <span class="number">0x55</span>, <span class="number">0x89</span>, <span class="number">0xE5</span>, <span class="number">0x83</span>, <span class="number">0xEC</span>, <span class="number">0x08</span>, <span class="number">0xE8</span>, <span class="number">0x7C</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC6</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x99</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x01</span>, <span class="number">0xC9</span>, <span class="number">0xF3</span>, <span class="number">0xC3</span>, <span class="number">0x66</span>, <span class="number">0x90</span>, <span class="number">0xA1</span>, <span class="number">0xD0</span>, <span class="number">0x97</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x85</span>, <span class="number">0xC0</span>, <span class="number">0x74</span>, <span class="number">0x1E</span>, <span class="number">0xB8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x85</span>, <span class="number">0xC0</span>, <span class="number">0x74</span>, <span class="number">0x15</span>, <span class="number">0x55</span>, <span class="number">0x89</span>, <span class="number">0xE5</span>, <span class="number">0x83</span>, <span class="number">0xEC</span>, <span class="number">0x18</span>, <span class="number">0xC7</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0xD0</span>, <span class="number">0x97</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0xFF</span>, <span class="number">0xD0</span>, <span class="number">0xC9</span>, <span class="number">0xE9</span>, <span class="number">0x79</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xE9</span>, <span class="number">0x74</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x55</span>, <span class="number">0x89</span>, <span class="number">0xE5</span>, <span class="number">0x5D</span>, <span class="number">0xC3</span>, <span class="number">0x8D</span>, <span class="number">0x74</span>, <span class="number">0x26</span>, <span class="number">0x00</span>, <span class="number">0x8D</span>, <span class="number">0xBC</span>, <span class="number">0x27</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x55</span>, <span class="number">0x89</span>, <span class="number">0xE5</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x53</span>, <span class="number">0xE8</span>, <span class="number">0x4F</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x81</span>, <span class="number">0xC3</span>, <span class="number">0x4D</span>, <span class="number">0x12</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x83</span>, <span class="number">0xEC</span>, <span class="number">0x1C</span>, <span class="number">0xE8</span>, <span class="number">0x9B</span>, <span class="number">0xFC</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x8D</span>, <span class="number">0xBB</span>, <span class="number">0x04</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x8D</span>, <span class="number">0x83</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x29</span>, <span class="number">0xC7</span>, <span class="number">0xC1</span>, <span class="number">0xFF</span>, <span class="number">0x02</span>, <span class="number">0x85</span>, <span class="number">0xFF</span>, <span class="number">0x74</span>, <span class="number">0x24</span>, <span class="number">0x31</span>, <span class="number">0xF6</span>, <span class="number">0x8B</span>, <span class="number">0x45</span>, <span class="number">0x10</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x08</span>, <span class="number">0x8B</span>, <span class="number">0x45</span>, <span class="number">0x0C</span>, <span class="number">0x89</span>, <span class="number">0x44</span>, <span class="number">0x24</span>, <span class="number">0x04</span>, <span class="number">0x8B</span>, <span class="number">0x45</span>, <span class="number">0x08</span>, <span class="number">0x89</span>, <span class="number">0x04</span>, <span class="number">0x24</span>, <span class="number">0xFF</span>, <span class="number">0x94</span>, <span class="number">0xB3</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x83</span>, <span class="number">0xC6</span>, <span class="number">0x01</span>, <span class="number">0x39</span>, <span class="number">0xFE</span>, <span class="number">0x72</span>, <span class="number">0xDE</span>, <span class="number">0x83</span>, <span class="number">0xC4</span>, <span class="number">0x1C</span>, <span class="number">0x5B</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x5D</span>, <span class="number">0xC3</span>, <span class="number">0x8B</span>, <span class="number">0x1C</span>, <span class="number">0x24</span>, <span class="number">0xC3</span>, <span class="number">0x90</span>, <span class="number">0x90</span>, <span class="number">0x55</span>, <span class="number">0x89</span>, <span class="number">0xE5</span>, <span class="number">0x53</span>, <span class="number">0x83</span>, <span class="number">0xEC</span>, <span class="number">0x04</span>, <span class="number">0xE8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x5B</span>, <span class="number">0x81</span>, <span class="number">0xC3</span>, <span class="number">0xEC</span>, <span class="number">0x11</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x59</span>, <span class="number">0x5B</span>, <span class="number">0xC9</span>, <span class="number">0xC3</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x00</span>, <span class="number">0x25</span>, <span class="number">0x73</span>, <span class="number">0x0A</span>, <span class="number">0x50</span>, <span class="number">0x6C</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x73</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x70</span>, <span class="number">0x75</span>, <span class="number">0x74</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x20</span>, <span class="number">0x66</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x67</span>, <span class="number">0x3A</span>, <span class="number">0x00</span>, <span class="number">0x25</span>, <span class="number">0x73</span>, <span class="number">0x00</span>, <span class="number">0x59</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x20</span>, <span class="number">0x61</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x67</span>, <span class="number">0x68</span>, <span class="number">0x74</span>, <span class="number">0x00</span>, <span class="number">0x59</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x20</span>, <span class="number">0x61</span>, <span class="number">0x72</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x77</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x67</span>, <span class="number">0x00</span>, <span class="number">0x7E</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> v0 = <span class="number">0x37A</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> v2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0x37A</span>; i++)&#123;</span><br><span class="line">        v2 = v1[i];</span><br><span class="line">        v0 = v2 ^ (v0 &gt;&gt; <span class="number">27</span>) ^ <span class="number">32</span> * v0;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"0x%08X\n"</span>, v0);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最终拿到<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v4 = v0 = <span class="number">0x7EEB184F</span></span><br></pre></td></tr></table></figure></p>
<p>但是用这个值去计算的话发现不对，多跑了几次，结果好像断点数和输入不一样这个值都会变，再看看题目的意思，估计断点不能乱下了。。。那就暴力点，直接patch二进制文件，让程序把值打出来。。。</p>
<p>接下来就是被霍霍成一大坨的if大判定了。。。其实都是写比较，几个函数：</p>
<ul>
<li><strong>PAIR</strong>(word, word) 比较两个16bit的值</li>
<li>BYTE1()～BYTE3() 分别取一个32bit值的第1～3个byte（从0开始，一个32bit的value有0,1,2,3四个byte</li>
</ul>
<p>用来比较的值也知道了，见上面的截图，这里单独按序列出来<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">valueForCmp = (<span class="number">0x5B18</span>, <span class="number">0xBF</span>, <span class="number">0x38</span>, <span class="number">0x34</span>, <span class="number">0x5A</span>, <span class="number">0x99</span>, <span class="number">0x4D</span>, <span class="number">0x2E</span>, <span class="number">0x73</span>, <span class="number">0xBB</span>, <span class="number">0x4E</span>, <span class="number">0x23</span>, <span class="number">0x9F76</span>, <span class="number">0x3</span>)</span><br></pre></td></tr></table></figure></p>
<p>用来比较的值从地址<strong>0x08049908到0x08049914</strong>，而且0x08049914指向的是个dword，所以实际上是0x14-0x8 + 0x1 + 0x3 = 0x10，即我们要输入的是16个字符</p>
<p>如上，if里的14次比较都都分析的差不多了，下面就好办了，直接脚本跑出来，要注意的就是比较时候的字节序问题了，可以上下两个<strong>valueForCmp</strong>有什么不同<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"><span class="comment">#! -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">valueForCmp = (<span class="number">0x18</span>, <span class="number">0x5B</span>, <span class="number">0xBF</span>, <span class="number">0x38</span>, <span class="number">0x34</span>, <span class="number">0x5A</span>, <span class="number">0x99</span>, <span class="number">0x4D</span>, <span class="number">0x2E</span>, <span class="number">0x73</span>, <span class="number">0xBB</span>, <span class="number">0x4E</span>, <span class="number">0x23</span>, <span class="number">0x76</span>, <span class="number">0x9F</span>, <span class="number">0x3</span>)</span><br><span class="line">value = (<span class="number">0x4F</span>, <span class="number">0x18</span>, <span class="number">0xEB</span>, <span class="number">0x7e</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deBreakPoint</span><span class="params">()</span>:</span></span><br><span class="line">    resList = []</span><br><span class="line">    resStr = <span class="string">''</span></span><br><span class="line">    TmpValue = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">16</span>):</span><br><span class="line">        TmpValue = (valueForCmp[i] ^ value[i%<span class="number">4</span>])</span><br><span class="line">        resList.append(chr(TmpValue))</span><br><span class="line">    resStr = resStr.join(resList)</span><br><span class="line">    <span class="keyword">return</span> resStr</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    res = deBreakPoint()</span><br><span class="line">    print(res)</span><br></pre></td></tr></table></figure></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color2">idf.cn</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/CTF/" class="article-tag-list-link color4">CTF</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-MSC2015-WriteUp" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/22/MSC2015-WriteUp/">MSC2015 WriteUp</a>
    </h1>
  

        
        <a href="/2015/10/22/MSC2015-WriteUp/" class="archive-article-date">
  	<time datetime="2015-10-22T09:45:08.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-10-22</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>##第一题：</p>
<p>和去年类似，程序运行后要求输入，输入正确的值才能得到答案，打开DDMS监控，尝试输入字符串查看log并观察其行为，Log里有提示invalid int，说明要求输入的是个int范围内的数。</p>
<p><img src="/images/msc2015/int.jpg" alt="int"></p>
<p>把程序丢到jeb里查看，发现关键函数check无法被解析</p>
<p><img src="/images/msc2015/check1.jpg" alt="check1"></p>
<p>使用<code>apktool d -d</code>反编译查看smali代码，看到反编译出了5万行代码，其中有大量通过动态反射调用的函数，但是调用的都是java库函数，函数名硬编码成Reverse字符串，运行时逆转成真正的函数名。但是猜测既然是输入的数字，应该会有比较，使用<code>apktool b -d</code>重打包，真机运行，使用netbeans动态调试，并且在check方法的所有cmp处下断点，最终在45540行的比较处发现，如果比较结果是不等，那么返回false，如果是true，则通过校验，程序显示蓝色字。</p>
<p><img src="/images/msc2015/check2.jpg" alt="check2"></p>
<p>多次运行，输入不同的数字，发现v10会变化，但是v4是定值，520676，说明v10应该和输入有关，向上找会修改v10的地方，找到第36111行，在此处下断，运行。</p>
<p><img src="/images/msc2015/check3.jpg" alt="check3"></p>
<p>输入123456789，发现第一次断在此处v20值是123456790,继续运行会再次断在此处，如此循环，循环结束后继续运行会跳到关键的比较行，在比较行上有把v6和v4相加存入v4的操作。查找循环的比较条件，可以看到15983行有个v0和v5的比较，其中v5是定值1001,直接修改v0为1001,则最终v4的值不再是520676,同时v10的值也不再是之前输入123456789的值，所以36111行处应该和计算过程相关，是核心过程，继续向上找36111行v20的相关行，找到10832行。</p>
<p><img src="/images/msc2015/check4.jpg" alt="check4"></p>
<p>重新运行程序，输入123456789，程序断在此处是，v10是输入值，v8的值从v0处取得，v0的值变化规律为从1开始递加4,一直到1001,然后15983行的比较生效，跳转，最终运行到关键比较点。<br>使用python脚本计算1到1001的递增为4的累加值，为124750，让程序一直运行到比较点，观察v10的值为123581539，减去124750,刚好为输入。</p>
<p>用v4的值减去124750,得到395926，即为key</p>
<p>##第二题</p>
<p>首先丢到jeb里分析，Ch函数里有个Morse码，解码后是WOJIUSHIDAAN，输入后不对，猜测是个坑。。<br>同时Ch里有做签名校验，重打包时需要patch掉。<br>apktool d -d 反编译，同时修改Ch的smali代码</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">116 a=0;//     <span class="comment">#v2=(Reference,Ljava/lang/String;);</span></span><br><span class="line">117 a=0;//    <span class="built_in"> const-string </span>v1, <span class="string">"WJmkxxkkGnYbExi3dqzeaA"</span></span><br><span class="line"><span class="keyword">.</span>.....</span><br><span class="line">120 a=0;//</span><br><span class="line">121 a=0;//    <span class="built_in"> move-result </span>v1</span><br><span class="line">122 a=0;//</span><br><span class="line">123 a=0;//     <span class="comment">#v1=(Boolean);</span></span><br><span class="line">124 a=0;//    <span class="built_in"> if-eqz </span>v1,<span class="keyword"> :cond_0</span> //需要修改的行</span><br></pre></td></tr></table></figure>
<p>同时发现有native方法ch用来check，使用ida动态调试，直接闪退，有反调试。静态分析，导出表还有mprotect，同时猜测可能有动态修改执行代码。<br>最终在init_array里找到两个反调试的入口点,1424和3160</p>
<p><img src="/images/msc2015/ddebug1.jpg" alt="ddebug1"></p>
<p>1424和3160里分别有调用到sub_1284和sub_3400，前者很明显去调用fopen读取 proc/pid/status的tracerpid，后者在运行时会被多次调用，包括在动态释放的代码里也会调用，如果返回一个小于0的值，那么会尝试像不可写内存里写值，导致程序崩溃。</p>
<p>使用bless打patch，把1284里的kill调用改为返回0,3400里的返回值改成0,使用的opcode是<strong>00 00 A0 E3 mov R0, #0</strong>，修改后如图：</p>
<p><img src="/images/msc2015/ddebug2.jpg" alt="ddebug2"><br><img src="/images/msc2015/ddebug3.jpg" alt="ddebug3"></p>
<p>重新附加调试器，可以正常调试，在<strong>Java_k2015_a2_Ch_ch</strong>处下断点，让程序继续运行，输入abcdefg，成功断在native函数ch处，运行到sub_1DE0[0x3CBAFDE0]时单步进入，此时可以看到传入参数为输入</p>
<p><img src="/images/msc2015/dyd1.jpg" alt="dyd1"></p>
<p>sub_1DE0中输入给了v1,然后mcpy到v43，最终在两个mprotect（其中有动态修改程序代码），后调用了函数loc_24C8[0x3CBB04C8]，步入前先使用idc脚本dump出来libwbox.so,此时的so里含有24C8的代码，可以用来静态分析，然后步入函数，查看其代码，对输入的字符串做了如下变换：</p>
<p><img src="/images/msc2015/dyd2.jpg" alt="dyd2"></p>
<p>变换后依然有动态修改代码的过程，然后调用loc_14A4[0x3CBAF4A4]，同样调用前dump出来so库，用于静态分析代码算法，在调用前会对输入进行变换，方法是输入的第i个元素的ASCII码加上i再存回数组，此时输入已经变为如下所示：</p>
<p><img src="/images/msc2015/dyd3.jpg" alt="dyd3"></p>
<p>在loc_14A4中会对输入再次变换，最终生成下面提到的16字节数组，计算方式如图：</p>
<p><img src="/images/msc2015/dyd4.jpg" alt="dyd4"></p>
<p>如图，用于计算的数组是[1F BC DA FF E6 4C BC 44  F5 B8 13 C8 EC A8 CD BD],计算方式是第i个元素的ASCII码加上上面对应的第i个数，结果保存为一个16字节数组。</p>
<p>最终在14A4中调用最终的一个动态生成的函数如图：</p>
<p><img src="/images/msc2015/dyd5.jpg" alt="dyd5"></p>
<p>传入的参数是[80 1F 3F 66 4F B7 29 52  05 CA 27 DE 04 C2 E9 DB]</p>
<p><img src="/images/msc2015/dyd6.jpg" alt="dyd6"></p>
<p>同样在调用前dump出来so库，用于分析</p>
<p>分析最终的函数，发现其做了10轮加密，且输入和输出都是16直接数组，根据经验，猜测是AES，问题在于序找密钥，分析代码，发现代码下面有16个字节被引用</p>
<p><img src="/images/msc2015/dyd7.jpg" alt="dyd7"></p>
<p>且参与了运算，所以猜测key是<br><strong>6BCDC67A6B2B7C9D8DA459B1AB9D0680</strong></p>
<p>使用此key，对下面说到的返回的结果进行解密结果相同，这里用到了一个在线解密网站，很好用，推荐一下<a href="http://testprotect.com/appendix/AEScalc" target="_blank" rel="noopener">http://testprotect.com/appendix/AEScalc</a></p>
<p>调用后函数会返回，返回结果是[0A BF F7 F6 C3 52 F1 21  6C 1E F5 A3 45 DB 32 29]<br>调用返回后再接着会对结果，v56，一个16字节数组进行比较，参与比较的数值是一个硬编码好的16字节数组，值为[5C DA 77 2F A3 C6 3E 39  B6 F0 F3 ED 51 5A 99 86]，如图：</p>
<p><img src="/images/msc2015/dyd8.jpg" alt="dyd8"></p>
<p>对此数组逆向算法，过程如下</p>
<ul>
<li>AES解密</li>
<li>反向loc_14A4的算法</li>
<li>反向loc_24C8的算法</li>
</ul>
<p>代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="string">""" Crack1 Calc"""</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(i &lt; <span class="number">1001</span>):</span><br><span class="line">    n += i</span><br><span class="line">    i += <span class="number">4</span></span><br><span class="line"></span><br><span class="line">print(n)</span><br><span class="line">print(<span class="number">123581539</span> - n)</span><br><span class="line">print(<span class="number">520676</span> - n)</span><br><span class="line"></span><br><span class="line"><span class="string">""" Crack2 Calc"""</span></span><br><span class="line">src = [<span class="number">0x8a</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0x6e</span>, <span class="number">0x59</span>, <span class="number">0xca</span>, <span class="number">0xf2</span>, <span class="number">0x52</span>, <span class="number">0x05</span>, <span class="number">0xca</span>, <span class="number">0x27</span>, <span class="number">0xde</span>, <span class="number">0x04</span>, <span class="number">0xc2</span>, <span class="number">0xe9</span>, <span class="number">0xdb</span>]</span><br><span class="line">srcPuls = [<span class="number">0x1F</span>, <span class="number">0xBC</span>, <span class="number">0xDA</span>, <span class="number">0xFF</span>, <span class="number">0xE6</span>, <span class="number">0x4C</span>, <span class="number">0xBC</span>, <span class="number">0x44</span>, <span class="number">0xF5</span>, <span class="number">0xB8</span>, <span class="number">0x13</span>, <span class="number">0xC8</span>, <span class="number">0xEC</span>, <span class="number">0xA8</span>, <span class="number">0xCD</span>, <span class="number">0xBD</span>]</span><br><span class="line">out1 = []</span><br><span class="line">out2 = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(src)):</span><br><span class="line">    out1.append((src[i] - srcPuls[i]) %<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(out1)):</span><br><span class="line">    out2.append((out1[i] - i))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(out2)):</span><br><span class="line">    print(chr(out2[i]), end=<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">""</span>)</span><br></pre></td></tr></table></figure>
<p>最终结果是kboloy0</p>
<p>##第三题</p>
<p>唔，给bin爷爷跪了。。。</p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">WriteUp</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">MSC2015</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/CTF/" class="article-tag-list-link color4">CTF</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
    <article id="post-Dump-Dex-From-IJiaMi" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/07/Dump-Dex-From-IJiaMi/">Dump Dex From IJiaMi</a>
    </h1>
  

        
        <a href="/2015/10/07/Dump-Dex-From-IJiaMi/" class="archive-article-date">
  	<time datetime="2015-10-07T15:20:29.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-10-07</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>内容仅供学习讨论</strong><br><strong>参考文档：</strong> <em><a href="http://www.sycode.cn/2015/06/27/%E7%88%B1%E5%8A%A0%E5%AF%86-%E5%8A%A8%E6%80%81%E8%84%B1%E5%A3%B3%E4%B9%8B%E3%80%90%E6%99%BA%E8%83%BD%E8%A7%86%E7%AA%97app%E3%80%91%E8%84%B1%E5%A3%B3%E4%BF%AE%E5%A4%8D/#0x001" target="_blank" rel="noopener">爱加密动态脱壳</a>，<a href="http://www.cnblogs.com/2014asm/p/4112116.html" target="_blank" rel="noopener">爱加密动态脱壳法</a>，<a href="http://www.9hao.info/pages/2014/07/qian-tan-androidni-xiang-fen-xi-na-xie-lan-lu-hu" target="_blank" rel="noopener">浅谈android逆向分析那些拦路虎</a>，<a href="http://burningcodes.net/%E4%BB%8E%E6%BA%90%E7%A0%81%E4%B8%AD%E8%B7%9F%E8%B8%AAdex%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%B5%81%E7%A8%8B/" target="_blank" rel="noopener">光哥博客</a></em></p>
<p>#0x1 说在开头</p>
<p>现在有很多软件都是有加壳的，作为安全狗肯定要研究研究，从网上找了点资料，然后找了个用IJiaMi加固的顺着做了一下。</p>
<p>#0x2 实验环境</p>
<ul>
<li>Android 真机，Version 4.1.2， with <strong>ROOT &amp; Xposed</strong></li>
<li>某被IJiaMi加固的App</li>
<li>IDA调试器</li>
<li>adb</li>
</ul>
<p>#0x3 过程</p>
<p>下断点：</p>
<ul>
<li>libc.so fgets fopen</li>
<li>libdvm.so _Z21dvmDexFileOpenPartialPKviPP6DvmDex</li>
</ul>
<p>这里关于为何在fgets和fopen上下断点的原因几乎都有说明，是因为加固措施里有反调试，方法是使用子进程检测父进程是否被ptrace（即被调试），如果有则强制关闭说有进程，而检测方法就是读取<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/</span><br><span class="line"> |---proc/[pid]/status</span><br></pre></td></tr></table></figure></p>
<p>对于这个我也写了个，大概实现可以看这里：<a href="https://github.com/ExiaHan/exiahanLib/blob/master/exiahanLib.c" target="_blank" rel="noopener">getTracerPid</a></p>
<p>文件里的TracerPid行，如果为0说明没有被调试，否则就是调试器的PID<br>所以要在fgets和fopen上下断，找到其打开后获取值的语句，改为0,patch掉反调试</p>
<p><em>真正调试时发现其实不需要每次都patch掉，只要找到用于反调试的子进程，然后直接休眠掉即可，否则如果碰到变态的每隔几秒就检测一次的加固方式，那就只能一直人工patch了┗&lt;(=｀o′=)&gt;┓哼 ┏&lt;(=｀○′=)&gt;┛哼┏&lt;(=｀o′=)&gt;┓哈┗&lt;(=｀O′=)&gt;┛兮！！</em></p>
<p>再下来是<strong>_Z21dvmDexFileOpenPartialPKviPP6DvmDex</strong>，位于libdvm.so，libdvm是library-dalvik-virtual-machine，即dalvik虚拟机的核心所在shared object，其中的<em>_Z21dvmDexFileOpenPartialPKviPP6DvmDex</em>即为运行一个dex前需要调用的<strong>参与打开dex文件</strong>的一个函数，为什么要在这里下断呢？</p>
<p>去源码dalvik文件夹下执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -rn dvmDexFileOpen</span><br></pre></td></tr></table></figure></p>
<p>可以找到dvmDexFileOpenPartial函数，其定义位于./dalvik/vm/DvmDex.h:84，如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">72</span> <span class="comment">/*</span></span><br><span class="line"><span class="comment">73  * Given a file descriptor for an open "optimized" DEX file, map it into</span></span><br><span class="line"><span class="comment">74  * memory and parse the contents.</span></span><br><span class="line"><span class="comment">75  *</span></span><br><span class="line"><span class="comment">76  * On success, returns 0 and sets "*ppDvmDex" to a newly-allocated DvmDex.</span></span><br><span class="line"><span class="comment">77  * On failure, returns a meaningful error code [currently just -1].</span></span><br><span class="line"><span class="comment">78  */</span></span><br><span class="line"><span class="number">79</span> <span class="function"><span class="keyword">int</span> <span class="title">dvmDexFileOpenFromFd</span><span class="params">(<span class="keyword">int</span> fd, DvmDex** ppDvmDex)</span></span>;</span><br><span class="line"><span class="number">80</span> </span><br><span class="line"><span class="number">81</span> <span class="comment">/*</span></span><br><span class="line"><span class="comment">82  * Open a partial DEX file.  Only useful as part of the optimization process.</span></span><br><span class="line"><span class="comment">83  */</span></span><br><span class="line"><span class="number">84</span> <span class="function"><span class="keyword">int</span> <span class="title">dvmDexFileOpenPartial</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span>* addr, <span class="keyword">int</span> len, DvmDex** ppDvmDex)</span></span>;</span><br><span class="line"><span class="number">85</span> </span><br><span class="line"><span class="number">86</span> <span class="comment">/*</span></span><br><span class="line"><span class="comment">87  * Free a DvmDex structure, along with any associated structures.</span></span><br><span class="line"><span class="comment">88  */</span></span><br><span class="line"><span class="number">89</span> <span class="function"><span class="keyword">void</span> <span class="title">dvmDexFileFree</span><span class="params">(DvmDex* pDvmDex)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p>可以看到三个和加载dex（包括odex）的函数都在这里，就像注释说明的，dvmDexFileOpenPartial函数是加载dex文件必须用到的一步，其前两个参数分别是dex文件在内存中的地址和其长度，知道这些后就可以尝试现在这里下断然后尝试dump出来dex文件啦。所以在其中下断，就能找到运行时所加载的真正dex文件，然后使用IDC脚本dump出来即可.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> fp, dexAddress;</span><br><span class="line">fp = fopen(<span class="string">"C:\\xx.dex"</span>,<span class="string">"wb"</span>);</span><br><span class="line"><span class="keyword">for</span> (dexAddress = <span class="number">0x3D4AE72C</span>; dexAddress &lt; <span class="number">0x3DB9C098</span>; dexAddress++)</span><br><span class="line">   fputc(Byte(dexAddress), fp)</span><br></pre></td></tr></table></figure>
<p><del>脱掉后dex2jar转成jar用jd-gui看下真正的入口Activity，然后baksmali一下，把manifest.xml里的入口改掉，改成真正入口Activity。</del></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">Reverse</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color3">Android</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">Dex</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/UnShell/" class="article-tag-list-link color3">UnShell</a>
        		</li>
      		
		</ul>
	</div>


      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>








  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2019 ExiaHan
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="./",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=/\/|index.html/g;return t.replace(e,"")===n.replace(e,"")}function i(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,e=0,r=t.length;e<r;e++){var i=t[e];o(n,i.getAttribute("href"))&&(0,d.default)(i,"active")}}function u(t){for(var n=t.offsetLeft,e=t.offsetParent;null!==e;)n+=e.offsetLeft,e=e.offsetParent;return n}function f(t){for(var n=t.offsetTop,e=t.offsetParent;null!==e;)n+=e.offsetTop,e=e.offsetParent;return n}function c(t,n,e,r,o){var i=u(t),c=f(t)-n;if(c-e<=o){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,h.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(e||c)+"px",a.style.left=i+"px",a.style.zIndex=r||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");c(t,document.body.scrollTop,-63,2,0),c(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}function l(){x.default.versions.mobile&&window.screen.width<800&&(i(),s())}var p=e(71),d=r(p),v=e(72),y=(r(v),e(84)),h=r(y),b=e(69),x=r(b),m=e(75),g=r(m),w=e(70);l(),(0,w.addLoadEvent)(function(){g.default.init()}),t.exports={}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(49),o=e(15);t.exports=function(t){return r(o(t))}},function(t,n,e){t.exports=!e(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(6),o=e(12);t.exports=e(4)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(10),o=e(30),i=e(24),u=Object.defineProperty;n.f=e(4)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(22)("wks"),o=e(13),i=e(1).Symbol,u="function"==typeof i,f=t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))};f.store=r},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(35),o=e(16);t.exports=Object.keys||function(t){return r(t,o)}},function(t,n,e){var r=e(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(6).f,o=e(2),i=e(7)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){var r=e(22)("keys"),o=e(13);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,n,e){var r=e(1),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n,e){var r=e(1),o=e(14),i=e(18),u=e(26),f=e(6).f;t.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||f(n,t,{value:u.f(t)})}},function(t,n,e){n.f=e(7)},function(t,n,e){var r=e(1),o=e(14),i=e(46),u=e(5),f="prototype",c=function(t,n,e){var a,s,l,p=t&c.F,d=t&c.G,v=t&c.S,y=t&c.P,h=t&c.B,b=t&c.W,x=d?o:o[n]||(o[n]={}),m=x[f],g=d?r:v?r[n]:(r[n]||{})[f];d&&(e=n);for(a in e)s=!p&&g&&void 0!==g[a],s&&a in x||(l=s?g[a]:e[a],x[a]=d&&"function"!=typeof g[a]?e[a]:h&&s?i(l,r):b&&g[a]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[f]=t[f],n}(l):y&&"function"==typeof l?i(Function.call,l):l,y&&((x.virtual||(x.virtual={}))[a]=l,t&c.R&&m&&!m[a]&&u(m,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(11),o=e(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){t.exports=!e(4)&&!e(8)(function(){return 7!=Object.defineProperty(e(29)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){"use strict";var r=e(18),o=e(27),i=e(36),u=e(5),f=e(2),c=e(17),a=e(51),s=e(20),l=e(58),p=e(7)("iterator"),d=!([].keys&&"next"in[].keys()),v="@@iterator",y="keys",h="values",b=function(){return this};t.exports=function(t,n,e,x,m,g,w){a(e,n,x);var O,S,_,j=function(t){if(!d&&t in A)return A[t];switch(t){case y:return function(){return new e(this,t)};case h:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",E=m==h,M=!1,A=t.prototype,T=A[p]||A[v]||m&&A[m],L=T||j(m),N=m?E?j("entries"):L:void 0,C="Array"==n?A.entries||T:T;if(C&&(_=l(C.call(new t)),_!==Object.prototype&&(s(_,P,!0),r||f(_,p)||u(_,p,b))),E&&T&&T.name!==h&&(M=!0,L=function(){return T.call(this)}),r&&!w||!d&&!M&&A[p]||u(A,p,L),c[n]=L,c[P]=b,m)if(O={values:E?L:j(h),keys:g?L:j(y),entries:N},w)for(S in O)S in A||i(A,S,O[S]);else o(o.P+o.F*(d||M),n,O);return O}},function(t,n,e){var r=e(10),o=e(55),i=e(16),u=e(21)("IE_PROTO"),f=function(){},c="prototype",a=function(){var t,n=e(29)("iframe"),r=i.length,o="<",u=">";for(n.style.display="none",e(48).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(o+"script"+u+"document.F=Object"+o+"/script"+u),t.close(),a=t.F;r--;)delete a[c][i[r]];return a()};t.exports=Object.create||function(t,n){var e;return null!==t?(f[c]=r(t),e=new f,f[c]=null,e[u]=t):e=a(),void 0===n?e:o(e,n)}},function(t,n,e){var r=e(35),o=e(16).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(2),o=e(3),i=e(45)(!1),u=e(21)("IE_PROTO");t.exports=function(t,n){var e,f=o(t),c=0,a=[];for(e in f)e!=u&&r(f,e)&&a.push(e);for(;n.length>c;)r(f,e=n[c++])&&(~i(a,e)||a.push(e));return a}},function(t,n,e){t.exports=e(5)},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(41),__esModule:!0}},function(t,n,e){t.exports={default:e(42),__esModule:!0}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var o=e(39),i=r(o),u=e(38),f=r(u),c="function"==typeof f.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":typeof t};n.default="function"==typeof f.default&&"symbol"===c(i.default)?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,n,e){e(65),e(63),e(66),e(67),t.exports=e(14).Symbol},function(t,n,e){e(64),e(68),t.exports=e(26).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(3),o=e(61),i=e(60);t.exports=function(t){return function(n,e,u){var f,c=r(n),a=o(c.length),s=i(u,a);if(t&&e!=e){for(;a>s;)if(f=c[s++],f!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(43);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n,e){var r=e(9),o=e(34),i=e(19);t.exports=function(t){var n=r(t),e=o.f;if(e)for(var u,f=e(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&n.push(u);return n}},function(t,n,e){t.exports=e(1).document&&document.documentElement},function(t,n,e){var r=e(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,n,e){"use strict";var r=e(32),o=e(12),i=e(20),u={};e(5)(u,e(7)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r=e(9),o=e(3);t.exports=function(t,n){for(var e,i=o(t),u=r(i),f=u.length,c=0;f>c;)if(i[e=u[c++]]===n)return e}},function(t,n,e){var r=e(13)("meta"),o=e(11),i=e(2),u=e(6).f,f=0,c=Object.isExtensible||function(){return!0},a=!e(8)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:"O"+ ++f,w:{}}})},l=function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!n)return"E";s(t)}return t[r].i},p=function(t,n){if(!i(t,r)){if(!c(t))return!0;if(!n)return!1;s(t)}return t[r].w},d=function(t){return a&&v.NEED&&c(t)&&!i(t,r)&&s(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(t,n,e){var r=e(6),o=e(10),i=e(9);t.exports=e(4)?Object.defineProperties:function(t,n){o(t);for(var e,u=i(n),f=u.length,c=0;f>c;)r.f(t,e=u[c++],n[e]);return t}},function(t,n,e){var r=e(19),o=e(12),i=e(3),u=e(24),f=e(2),c=e(30),a=Object.getOwnPropertyDescriptor;n.f=e(4)?a:function(t,n){if(t=i(t),n=u(n,!0),c)try{return a(t,n)}catch(t){}if(f(t,n))return o(!r.f.call(t,n),t[n])}},function(t,n,e){var r=e(3),o=e(33).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?f(t):o(r(t))}},function(t,n,e){var r=e(2),o=e(37),i=e(21)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,e){var r=e(23),o=e(15);t.exports=function(t){return function(n,e){var i,u,f=String(o(n)),c=r(e),a=f.length;return c<0||c>=a?t?"":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r=e(23),o=Math.max,i=Math.min;t.exports=function(t,n){return t=r(t),t<0?o(t+n,0):i(t,n)}},function(t,n,e){var r=e(23),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){"use strict";var r=e(44),o=e(52),i=e(17),u=e(3);t.exports=e(31)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n){},function(t,n,e){"use strict";var r=e(59)(!0);e(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){"use strict";var r=e(1),o=e(2),i=e(4),u=e(27),f=e(36),c=e(54).KEY,a=e(8),s=e(22),l=e(20),p=e(13),d=e(7),v=e(26),y=e(25),h=e(53),b=e(47),x=e(50),m=e(10),g=e(3),w=e(24),O=e(12),S=e(32),_=e(57),j=e(56),P=e(6),E=e(9),M=j.f,A=P.f,T=_.f,L=r.Symbol,N=r.JSON,C=N&&N.stringify,k="prototype",F=d("_hidden"),q=d("toPrimitive"),I={}.propertyIsEnumerable,B=s("symbol-registry"),D=s("symbols"),W=s("op-symbols"),H=Object[k],K="function"==typeof L,R=r.QObject,J=!R||!R[k]||!R[k].findChild,U=i&&a(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=M(H,n);r&&delete H[n],A(t,n,e),r&&t!==H&&A(H,n,r)}:A,G=function(t){var n=D[t]=S(L[k]);return n._k=t,n},$=K&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},z=function(t,n,e){return t===H&&z(W,n,e),m(t),n=w(n,!0),m(e),o(D,n)?(e.enumerable?(o(t,F)&&t[F][n]&&(t[F][n]=!1),e=S(e,{enumerable:O(0,!1)})):(o(t,F)||A(t,F,O(1,{})),t[F][n]=!0),U(t,n,e)):A(t,n,e)},Y=function(t,n){m(t);for(var e,r=b(n=g(n)),o=0,i=r.length;i>o;)z(t,e=r[o++],n[e]);return t},Q=function(t,n){return void 0===n?S(t):Y(S(t),n)},X=function(t){var n=I.call(this,t=w(t,!0));return!(this===H&&o(D,t)&&!o(W,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,F)&&this[F][t])||n)},V=function(t,n){if(t=g(t),n=w(n,!0),t!==H||!o(D,n)||o(W,n)){var e=M(t,n);return!e||!o(D,n)||o(t,F)&&t[F][n]||(e.enumerable=!0),e}},Z=function(t){for(var n,e=T(g(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==F||n==c||r.push(n);return r},tt=function(t){for(var n,e=t===H,r=T(e?W:g(t)),i=[],u=0;r.length>u;)!o(D,n=r[u++])||e&&!o(H,n)||i.push(D[n]);return i};K||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),n=function(e){this===H&&n.call(W,e),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,e))};return i&&J&&U(H,t,{configurable:!0,set:n}),G(t)},f(L[k],"toString",function(){return this._k}),j.f=V,P.f=z,e(33).f=_.f=Z,e(19).f=X,e(34).f=tt,i&&!e(18)&&f(H,"propertyIsEnumerable",X,!0),v.f=function(t){return G(d(t))}),u(u.G+u.W+u.F*!K,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;nt.length>et;)d(nt[et++]);for(var nt=E(d.store),et=0;nt.length>et;)y(nt[et++]);u(u.S+u.F*!K,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if($(t))return h(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){J=!0},useSimple:function(){J=!1}}),u(u.S+u.F*!K,"Object",{create:Q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),N&&u(u.S+u.F*(!K||a(function(){var t=L();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return n=r[1],"function"==typeof n&&(e=n),!e&&x(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!$(n))return n}),r[1]=n,C.apply(N,r)}}}),L[k][q]||e(5)(L[k],q,L[k].valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,n,e){e(25)("asyncIterator")},function(t,n,e){e(25)("observable")},function(t,n,e){e(62);for(var r=e(1),o=e(5),i=e(17),u=e(7)("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,n){"use strict";var e={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")==-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")==-1,weixin:t.indexOf("MicroMessenger")==-1}}()};t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(40),i=r(o),u=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):o[t]||t}function n(t){return l[t]}var e=/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,r=/['<> "&]/g,o={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},f=/\u00a0/g,c=/<br\s*\/?>/gi,a=/\r?\n/g,s=/\s/g,l={};for(var p in o)l[o[p]]=p;return o["&apos;"]="'",l["'"]="&#39;",{encode:function(t){return t?(""+t).replace(r,n).replace(a,"<br/>").replace(s,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(c,"\n").replace(e,t).replace(f," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e+=2)n.push(String.fromCharCode("0x"+t.slice(e,e+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,e=t.length;e>n;n++)t[n]=u.encodeObject(t[n]);else if("object"==("undefined"==typeof t?"undefined":(0,i.default)(t)))for(var r in t)t[r]=u.encodeObject(t[r]);else if("string"==typeof t)return u.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=u},function(t,n){function e(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=e},function(t,n){function e(t,n){if(t.classList)t.classList.remove(n);else{var e=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(e," ")}}t.exports=e},,,function(t,n){"use strict";function e(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){var n=document.querySelectorAll(".article-entry a:not(.article-more-a)");n.forEach(function(t){t.setAttribute("target","_blank")})}var e=document.querySelector("#js-aboutme");e&&0!==e.length&&(e.innerHTML=e.innerText)}t.exports={init:e}},,,,,,,,,function(t,n){function e(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var e=t.nextSibling;return e?t.parentNode.insertBefore(n,e):t.parentNode.appendChild(n)}t.exports=e}])</script><script src="/./main.4a39e8.js"></script><script>!function(){var e=function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)};e("/slider.e97a05.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">CTF</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Reverse</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">SimpleXue</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">Android</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Dex</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">LVM</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">ArchLinux</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Linux</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ELF</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Shell</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Happy New Year</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">LifeContinues</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Build</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">SQLITE</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">NSCTF2015</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">WriteUp</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">MSC2015</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Life</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Vision</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Nginx</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Https</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Hexo</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Android-Studio</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">SubsTrate</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ABI</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">Security</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">XDCTF2015</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Xposed</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">AntiDebug</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Signature Verify</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">Hook</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">GDB</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">Ptrace</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">idf.cn</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            2、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://burningcodes.net/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>光哥</a>
            </li>
          
            <li class="search-li">
              <a href="http://blog.icehoney.me/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>雪月秋水</a>
            </li>
          
            <li class="search-li">
              <a href="http://farseerfc.me/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>farseerfc苣菊</a>
            </li>
          
            <li class="search-li">
              <a href="http://blog.phoenixlzx.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>phoenixlzx</a>
            </li>
          
            <li class="search-li">
              <a href="http://blog.felixc.at/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>felixonmars</a>
            </li>
          
            <li class="search-li">
              <a href="http://lilydjwg.is-programmer.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>百合仙子</a>
            </li>
          
            <li class="search-li">
              <a href="http://nazcalines.github.io/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>汀神</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.programlife.net/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>代码疯子</a>
            </li>
          
            <li class="search-li">
              <a href="https://blog.brickgao.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>高苣菊</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.xiaobaiyey.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>大白的小窝</a>
            </li>
          
            <li class="search-li">
              <a href="http://www.qc1iu.org/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>编译川</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">初出茅庐的安全狗，&lt;br&gt;10级小菜鸟&lt;br&gt;满级200..</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>